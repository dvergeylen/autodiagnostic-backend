var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function i(t){t.forEach(e)}function o(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function r(e,...n){if(null==e)return t;const i=e.subscribe(...n);return i.unsubscribe?()=>i.unsubscribe():i}function u(t,e,n){t.$$.on_destroy.push(r(e,n))}function s(t,e,n=e){return t.set(n),e}function a(t,e){t.appendChild(e)}function c(t,e,n){t.insertBefore(e,n||null)}function d(t){t.parentNode.removeChild(t)}function f(t){return document.createElement(t)}function g(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function p(t){return document.createTextNode(t)}function h(){return p(" ")}function m(){return p("")}function v(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function N(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function $(t){return""===t?null:+t}function b(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function x(t,e){t.value=null==e?"":e}function y(t,e){for(let n=0;n<t.options.length;n+=1){const i=t.options[n];if(i.__value===e)return void(i.selected=!0)}}function k(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function _(t,e,n){t.classList[n?"add":"remove"](e)}let w;function C(t){w=t}function j(){const t=function(){if(!w)throw new Error("Function called outside component initialization");return w}();return(e,n)=>{const i=t.$$.callbacks[e];if(i){const o=function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(e,n);i.slice().forEach((e=>{e.call(t,o)}))}}}const O=[],q=[],z=[],E=[],S=Promise.resolve();let P=!1;function I(){P||(P=!0,S.then(R))}function A(t){z.push(t)}function M(t){E.push(t)}let D=!1;const L=new Set;function R(){if(!D){D=!0;do{for(let t=0;t<O.length;t+=1){const e=O[t];C(e),V(e.$$)}for(C(null),O.length=0;q.length;)q.pop()();for(let t=0;t<z.length;t+=1){const e=z[t];L.has(e)||(L.add(e),e())}z.length=0}while(O.length);for(;E.length;)E.pop()();P=!1,D=!1,L.clear()}}function V(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(A)}}const U=new Set;let J;function B(){J={r:0,c:[],p:J}}function F(){J.r||i(J.c),J=J.p}function T(t,e){t&&t.i&&(U.delete(t),t.i(e))}function G(t,e,n,i){if(t&&t.o){if(U.has(t))return;U.add(t),J.c.push((()=>{U.delete(t),i&&(n&&t.d(1),i())})),t.o(e)}}function H(t,e){G(t,1,1,(()=>{e.delete(t.key)}))}function K(t,e,n,i,o,l,r,u,s,a,c,d){let f=t.length,g=l.length,p=f;const h={};for(;p--;)h[t[p].key]=p;const m=[],v=new Map,N=new Map;for(p=g;p--;){const t=d(o,l,p),u=n(t);let s=r.get(u);s?i&&s.p(t,e):(s=a(u,t),s.c()),v.set(u,m[p]=s),u in h&&N.set(u,Math.abs(p-h[u]))}const $=new Set,b=new Set;function x(t){T(t,1),t.m(u,c),r.set(t.key,t),c=t.first,g--}for(;f&&g;){const e=m[g-1],n=t[f-1],i=e.key,o=n.key;e===n?(c=e.first,f--,g--):v.has(o)?!r.has(i)||$.has(i)?x(e):b.has(o)?f--:N.get(i)>N.get(o)?(b.add(i),x(e)):($.add(o),f--):(s(n,r),f--)}for(;f--;){const e=t[f];v.has(e.key)||s(e,r)}for(;g;)x(m[g-1]);return m}function Q(t,e,n){const i=t.$$.props[e];void 0!==i&&(t.$$.bound[i]=n,n(t.$$.ctx[i]))}function W(t){t&&t.c()}function X(t,n,l,r){const{fragment:u,on_mount:s,on_destroy:a,after_update:c}=t.$$;u&&u.m(n,l),r||A((()=>{const n=s.map(e).filter(o);a?a.push(...n):i(n),t.$$.on_mount=[]})),c.forEach(A)}function Y(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Z(e,o,l,r,u,s,a=[-1]){const c=w;C(e);const f=e.$$={fragment:null,ctx:null,props:s,update:t,not_equal:u,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(c?c.$$.context:o.context||[]),callbacks:n(),dirty:a,skip_bound:!1};let g=!1;if(f.ctx=l?l(e,o.props||{},((t,n,...i)=>{const o=i.length?i[0]:n;return f.ctx&&u(f.ctx[t],f.ctx[t]=o)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](o),g&&function(t,e){-1===t.$$.dirty[0]&&(O.push(t),I(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(e,t)),n})):[],f.update(),g=!0,i(f.before_update),f.fragment=!!r&&r(f.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);f.fragment&&f.fragment.l(t),t.forEach(d)}else f.fragment&&f.fragment.c();o.intro&&T(e.$$.fragment),X(e,o.target,o.anchor,o.customElement),R()}C(c)}class tt{$destroy(){Y(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function et(t){let e,n,i;return{c(){e=f("input"),N(e,"type","text"),N(e,"class","svelte-zog1mk")},m(o,l){c(o,e,l),x(e,t[0].text.fr),n||(i=v(e,"input",t[4]),n=!0)},p(t,n){1&n&&e.value!==t[0].text.fr&&x(e,t[0].text.fr)},d(t){t&&d(e),n=!1,i()}}}function nt(t){let e,n,o,l,r,u,s,g,m,$;return{c(){e=f("div"),n=f("p"),o=p("m: "),l=f("input"),r=h(),u=f("p"),s=p("f: "),g=f("input"),N(l,"type","text"),N(l,"class","svelte-zog1mk"),N(n,"class","svelte-zog1mk"),N(g,"type","text"),N(g,"class","svelte-zog1mk"),N(u,"class","svelte-zog1mk"),N(e,"class","details svelte-zog1mk")},m(i,d){c(i,e,d),a(e,n),a(n,o),a(n,l),x(l,t[0].text.fr.m),a(e,r),a(e,u),a(u,s),a(u,g),x(g,t[0].text.fr.f),m||($=[v(l,"input",t[5]),v(g,"input",t[6])],m=!0)},p(t,e){1&e&&l.value!==t[0].text.fr.m&&x(l,t[0].text.fr.m),1&e&&g.value!==t[0].text.fr.f&&x(g,t[0].text.fr.f)},d(t){t&&d(e),m=!1,i($)}}}function it(e){let n,o,l,r,u,s,g,m,b,k,w,C,j,O,q,z,E,S,P,I,M,D,L,R,V,U,J,B,F,T,G,H,K,Q,W,X,Y,Z,tt,it,ot,lt,rt,ut,st,at,ct,dt,ft,gt,pt,ht,mt,vt,Nt,$t,bt,xt,yt,kt,_t="string"==typeof e[0].text.fr&&et(e),wt="object"==typeof e[0].text.fr&&nt(e);return{c(){n=f("div"),o=f("div"),l=p("Protagoniste:\n      "),r=f("select"),u=f("option"),u.textContent="Joueur",s=f("option"),s.textContent="NPC1",g=f("option"),g.textContent="Narrateur",m=h(),b=f("div"),k=p("FR:\n    "),_t&&_t.c(),w=h(),C=f("span"),C.textContent="m|f",j=h(),wt&&wt.c(),O=h(),q=f("div"),z=p("EN:\n    "),E=f("input"),S=h(),P=f("div"),I=p("URL Image:\n      "),M=f("input"),D=h(),L=f("div"),R=p("Attributions:\n    "),V=f("div"),U=f("div"),J=f("input"),B=p(" Leader"),F=h(),T=f("div"),G=f("input"),H=p(" Bricoleur"),K=h(),Q=f("div"),W=f("input"),X=p(" Coequipier"),Y=h(),Z=f("div"),tt=f("input"),it=p("Planificateur"),ot=h(),lt=f("div"),rt=f("input"),ut=p(" Idealiste"),st=h(),at=f("div"),ct=f("input"),dt=p(" Creatif"),ft=h(),gt=f("div"),pt=f("input"),ht=p("Audacieux"),mt=h(),vt=f("div"),Nt=f("input"),$t=p(" Explorateur"),bt=h(),xt=f("span"),xt.textContent="chiffres entiers positifs ou négatifs",u.__value="Player",u.value=u.__value,s.__value="NPC1",s.value=s.__value,g.__value="Narrator",g.value=g.__value,void 0===e[0].character&&A((()=>e[3].call(r))),N(o,"class","mb-3"),N(C,"class","svelte-zog1mk"),_(C,"is-enabled",e[1]),N(b,"class","mb-3"),N(E,"type","text"),N(E,"class","svelte-zog1mk"),N(q,"class","mb-3"),N(M,"type","text"),N(M,"class","svelte-zog1mk"),N(P,"class","mb-3"),N(J,"type","number"),N(J,"class","svelte-zog1mk"),N(G,"type","number"),N(G,"class","svelte-zog1mk"),N(W,"type","number"),N(W,"class","svelte-zog1mk"),N(tt,"type","number"),N(tt,"class","svelte-zog1mk"),N(rt,"type","number"),N(rt,"class","svelte-zog1mk"),N(ct,"type","number"),N(ct,"class","svelte-zog1mk"),N(pt,"type","number"),N(pt,"class","svelte-zog1mk"),N(Nt,"type","number"),N(Nt,"class","svelte-zog1mk"),N(V,"class","attribution-container svelte-zog1mk"),N(xt,"class","is-small is-italic"),N(n,"class","properties svelte-zog1mk"),_(n,"background-gray","Player"!==e[0].character)},m(t,i){c(t,n,i),a(n,o),a(o,l),a(o,r),a(r,u),a(r,s),a(r,g),y(r,e[0].character),a(n,m),a(n,b),a(b,k),_t&&_t.m(b,null),a(b,w),a(b,C),a(n,j),wt&&wt.m(n,null),a(n,O),a(n,q),a(q,z),a(q,E),x(E,e[0].text.en),a(n,S),a(n,P),a(P,I),a(P,M),x(M,e[0].imagePath),a(n,D),a(n,L),a(L,R),a(L,V),a(V,U),a(U,J),x(J,e[0].attribution.leader),a(U,B),a(V,F),a(V,T),a(T,G),x(G,e[0].attribution.bricoleur),a(T,H),a(V,K),a(V,Q),a(Q,W),x(W,e[0].attribution.coequipier),a(Q,X),a(V,Y),a(V,Z),a(Z,tt),x(tt,e[0].attribution.planificateur),a(Z,it),a(V,ot),a(V,lt),a(lt,rt),x(rt,e[0].attribution.idealiste),a(lt,ut),a(V,st),a(V,at),a(at,ct),x(ct,e[0].attribution.creatif),a(at,dt),a(V,ft),a(V,gt),a(gt,pt),x(pt,e[0].attribution.audacieux),a(gt,ht),a(V,mt),a(V,vt),a(vt,Nt),x(Nt,e[0].attribution.explorateur),a(vt,$t),a(L,bt),a(L,xt),yt||(kt=[v(r,"change",e[3]),v(C,"click",e[2]),v(E,"input",e[7]),v(M,"input",e[8]),v(J,"input",e[9]),v(G,"input",e[10]),v(W,"input",e[11]),v(tt,"input",e[12]),v(rt,"input",e[13]),v(ct,"input",e[14]),v(pt,"input",e[15]),v(Nt,"input",e[16])],yt=!0)},p(t,[e]){1&e&&y(r,t[0].character),"string"==typeof t[0].text.fr?_t?_t.p(t,e):(_t=et(t),_t.c(),_t.m(b,w)):_t&&(_t.d(1),_t=null),2&e&&_(C,"is-enabled",t[1]),"object"==typeof t[0].text.fr?wt?wt.p(t,e):(wt=nt(t),wt.c(),wt.m(n,O)):wt&&(wt.d(1),wt=null),1&e&&E.value!==t[0].text.en&&x(E,t[0].text.en),1&e&&M.value!==t[0].imagePath&&x(M,t[0].imagePath),1&e&&$(J.value)!==t[0].attribution.leader&&x(J,t[0].attribution.leader),1&e&&$(G.value)!==t[0].attribution.bricoleur&&x(G,t[0].attribution.bricoleur),1&e&&$(W.value)!==t[0].attribution.coequipier&&x(W,t[0].attribution.coequipier),1&e&&$(tt.value)!==t[0].attribution.planificateur&&x(tt,t[0].attribution.planificateur),1&e&&$(rt.value)!==t[0].attribution.idealiste&&x(rt,t[0].attribution.idealiste),1&e&&$(ct.value)!==t[0].attribution.creatif&&x(ct,t[0].attribution.creatif),1&e&&$(pt.value)!==t[0].attribution.audacieux&&x(pt,t[0].attribution.audacieux),1&e&&$(Nt.value)!==t[0].attribution.explorateur&&x(Nt,t[0].attribution.explorateur),1&e&&_(n,"background-gray","Player"!==t[0].character)},i:t,o:t,d(t){t&&d(n),_t&&_t.d(),wt&&wt.d(),yt=!1,i(kt)}}}function ot(t,e,n){let i,{dialogNode:o}=e;return t.$$set=t=>{"dialogNode"in t&&n(0,o=t.dialogNode)},t.$$.update=()=>{1&t.$$.dirty&&n(1,i="object"==typeof o.text.fr)},[o,i,function(){"object"==typeof o.text.fr?n(0,o.text.fr=o.text.fr.m,o):n(0,o.text.fr={m:o.text.fr,f:o.text.fr},o)},function(){o.character=k(this),n(0,o)},function(){o.text.fr=this.value,n(0,o)},function(){o.text.fr.m=this.value,n(0,o)},function(){o.text.fr.f=this.value,n(0,o)},function(){o.text.en=this.value,n(0,o)},function(){o.imagePath=this.value,n(0,o)},function(){o.attribution.leader=$(this.value),n(0,o)},function(){o.attribution.bricoleur=$(this.value),n(0,o)},function(){o.attribution.coequipier=$(this.value),n(0,o)},function(){o.attribution.planificateur=$(this.value),n(0,o)},function(){o.attribution.idealiste=$(this.value),n(0,o)},function(){o.attribution.creatif=$(this.value),n(0,o)},function(){o.attribution.audacieux=$(this.value),n(0,o)},function(){o.attribution.explorateur=$(this.value),n(0,o)}]}class lt extends tt{constructor(t){super(),Z(this,t,ot,it,l,{dialogNode:0})}}const rt=[];function ut(e,n=t){let i;const o=[];function r(t){if(l(e,t)&&(e=t,i)){const t=!rt.length;for(let t=0;t<o.length;t+=1){const n=o[t];n[1](),rt.push(n,e)}if(t){for(let t=0;t<rt.length;t+=2)rt[t][0](rt[t+1]);rt.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(l,u=t){const s=[l,u];return o.push(s),1===o.length&&(i=n(r)||t),l(e),()=>{const t=o.indexOf(s);-1!==t&&o.splice(t,1),0===o.length&&(i(),i=null)}}}}function st(e,n,l){const u=!Array.isArray(e),s=u?[e]:e,a=n.length<2;return{subscribe:ut(l,(e=>{let l=!1;const c=[];let d=0,f=t;const g=()=>{if(d)return;f();const i=n(u?c[0]:c,e);a?e(i):f=o(i)?i:t},p=s.map(((t,e)=>r(t,(t=>{c[e]=t,d&=~(1<<e),l&&g()}),(()=>{d|=1<<e}))));return l=!0,g(),function(){i(p),f()}})).subscribe}}const at=ut({metadata:{part:"I",chapter:"1"},dialogNodes:{}}),ct=st(at,(t=>Object.keys(t.dialogNodes).map((e=>{var n,i;return{id:e,text:`#${i=e,`${"0".repeat(5-String(i).length)}${i}`} - ${(null===(n=t.dialogNodes[e].text.fr)||void 0===n?void 0:n.m)||t.dialogNodes[e].text.fr}`}}))));function dt(t,e,n){const i=t.slice();return i[10]=e[n],i}function ft(t){let e,n,i,o,l=t[10].text+"";return{c(){e=f("option"),n=p(l),i=h(),e.__value=o=t[10].id,e.value=e.__value},m(t,o){c(t,e,o),a(e,n),a(e,i)},p(t,i){4&i&&l!==(l=t[10].text+"")&&b(n,l),4&i&&o!==(o=t[10].id)&&(e.__value=o,e.value=e.__value)},d(t){t&&d(e)}}}function gt(t){let e,n,o,l,r,u,s,a,g,p,m,N,$,b,x;function k(e){t[6](e)}let _={};void 0!==t[1]&&(_.dialogNode=t[1]),o=new lt({props:_}),q.push((()=>Q(o,"dialogNode",k)));let w=t[2],C=[];for(let e=0;e<w.length;e+=1)C[e]=ft(dt(t,w,e));return{c(){e=f("h5"),e.textContent="Nouvelle réplique",n=h(),W(o.$$.fragment),r=h(),u=f("button"),u.textContent="Ajouter",s=h(),a=f("h5"),a.textContent="Réplique existante",g=h(),p=f("select");for(let t=0;t<C.length;t+=1)C[t].c();m=h(),N=f("button"),N.textContent="Ajouter",void 0===t[0]&&A((()=>t[7].call(p)))},m(i,l){c(i,e,l),c(i,n,l),X(o,i,l),c(i,r,l),c(i,u,l),c(i,s,l),c(i,a,l),c(i,g,l),c(i,p,l);for(let t=0;t<C.length;t+=1)C[t].m(p,null);y(p,t[0]),c(i,m,l),c(i,N,l),$=!0,b||(x=[v(u,"click",t[4]),v(p,"change",t[7]),v(N,"click",t[3])],b=!0)},p(t,[e]){const n={};if(!l&&2&e&&(l=!0,n.dialogNode=t[1],M((()=>l=!1))),o.$set(n),4&e){let n;for(w=t[2],n=0;n<w.length;n+=1){const i=dt(t,w,n);C[n]?C[n].p(i,e):(C[n]=ft(i),C[n].c(),C[n].m(p,null))}for(;n<C.length;n+=1)C[n].d(1);C.length=w.length}5&e&&y(p,t[0])},i(t){$||(T(o.$$.fragment,t),$=!0)},o(t){G(o.$$.fragment,t),$=!1},d(t){t&&d(e),t&&d(n),Y(o,t),t&&d(r),t&&d(u),t&&d(s),t&&d(a),t&&d(g),t&&d(p),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(C,t),t&&d(m),t&&d(N),b=!1,i(x)}}}function pt(t,e,n){let i,o;u(t,at,(t=>n(8,i=t))),u(t,ct,(t=>n(2,o=t)));let l,{parentDialogNode:r}=e,a={id:"",text:{fr:"",en:""},nextNodes:[],character:"NPC1",attribution:{leader:0,bricoleur:0,coequipier:0,planificateur:0,idealiste:0,creatif:0,audacieux:0,explorateur:0}};const c=j();return t.$$set=t=>{"parentDialogNode"in t&&n(5,r=t.parentDialogNode)},[l,a,o,function(){r.nextNodes.includes(l)||s(at,i.dialogNodes[r.id].nextNodes=[...i.dialogNodes[r.id].nextNodes,l],i),c("toggleShowNewDialogNode",{toggleChildNodes:!1})},function(){let t=Object.keys(i.dialogNodes).reduce(((t,e)=>Number(e)>t?Number(e):t),1)+1;n(1,a.id=String(t),a),s(at,i.dialogNodes[String(t)]=a,i),s(at,i.dialogNodes[r.id].nextNodes=[...i.dialogNodes[r.id].nextNodes,String(t)],i),c("toggleShowNewDialogNode",{toggleChildNodes:!1})},r,function(t){a=t,n(1,a)},function(){l=k(this),n(0,l)}]}class ht extends tt{constructor(t){super(),Z(this,t,pt,gt,l,{parentDialogNode:5})}}const mt=st(at,(t=>Object.entries(t.dialogNodes).reduce(((t,[e,n])=>(n.nextNodes.forEach((n=>{t[n]=[...t[n]||[],e]})),t)),{}))),vt=st([at,mt],(t=>Object.keys(t[0].dialogNodes).reduce(((e,n)=>t[1][n]||"1"===n?e:[...e,n]),[]))),Nt=st([at,mt],(t=>Object.keys(t[0].dialogNodes).reduce(((e,n)=>{var i;return(null===(i=t[1][n])||void 0===i?void 0:i.length)>1?[...e,n]:e}),[])));function $t(t,e,n){const i=t.slice();return i[23]=e[n],i[24]=e,i[25]=n,i}function bt(e){let n;return{c(){n=f("span"),n.textContent="¤",N(n,"title","Noeud terminal"),N(n,"class","svelte-idywcr")},m(t,e){c(t,n,e)},p:t,d(t){t&&d(n)}}}function xt(t){let e,n,o,l,r,u,s,m,$,x,y,k,w,C=t[0].nextNodes.length+"";return{c(){e=g("svg"),n=g("use"),o=h(),l=g("svg"),r=g("use"),u=h(),s=f("span"),m=p("("),$=p(C),x=p(")"),N(n,"href","assets/sprite_icons.svg#angle-double-right"),_(e,"is-hidden",t[6]),N(r,"href","assets/sprite_icons.svg#angle-double-down"),_(l,"is-hidden",!t[6]),N(s,"class","is-primary svelte-idywcr"),N(s,"title",y="Ce noeud mène à "+t[0].nextNodes.length+" réplique(s)")},m(i,d){c(i,e,d),a(e,n),c(i,o,d),c(i,l,d),a(l,r),c(i,u,d),c(i,s,d),a(s,m),a(s,$),a(s,x),k||(w=[v(e,"click",t[13]),v(l,"click",t[13]),v(s,"click",t[13])],k=!0)},p(t,n){64&n&&_(e,"is-hidden",t[6]),64&n&&_(l,"is-hidden",!t[6]),1&n&&C!==(C=t[0].nextNodes.length+"")&&b($,C),1&n&&y!==(y="Ce noeud mène à "+t[0].nextNodes.length+" réplique(s)")&&N(s,"title",y)},d(t){t&&d(e),t&&d(o),t&&d(l),t&&d(u),t&&d(s),k=!1,i(w)}}}function yt(e){let n,i,o,l,r;return{c(){n=f("span"),i=g("svg"),o=g("use"),N(o,"href","assets/sprite_icons.svg#times-circle-solid"),N(i,"class","is-float-right ml-1"),N(n,"title","Supprimer le noeud (irréversible)"),N(n,"class","svelte-idywcr")},m(t,u){c(t,n,u),a(n,i),a(i,o),l||(r=v(i,"click",e[17]),l=!0)},p:t,d(t){t&&d(n),l=!1,r()}}}function kt(e){let n,i,o,l,r;return{c(){n=f("span"),i=g("svg"),o=g("use"),N(o,"href","assets/sprite_icons.svg#times-circle-regular"),N(i,"class","is-float-right"),N(n,"title","Supprimer la filiation (le noeud ne sera pas supprimé, seul son lien avec son noeud parent)"),N(n,"class","svelte-idywcr")},m(t,u){c(t,n,u),a(n,i),a(i,o),l||(r=v(i,"click",e[16]),l=!0)},p:t,d(t){t&&d(n),l=!1,r()}}}function _t(t){let e,n,i;function o(e){t[20](e)}let l={};return void 0!==t[0]&&(l.dialogNode=t[0]),e=new lt({props:l}),q.push((()=>Q(e,"dialogNode",o))),{c(){W(e.$$.fragment)},m(t,n){X(e,t,n),i=!0},p(t,i){const o={};!n&&1&i&&(n=!0,o.dialogNode=t[0],M((()=>n=!1))),e.$set(o)},i(t){i||(T(e.$$.fragment,t),i=!0)},o(t){G(e.$$.fragment,t),i=!1},d(t){Y(e,t)}}}function wt(t){let e,n;return e=new ht({props:{parentDialogNode:t[0]}}),e.$on("toggleShowNewDialogNode",t[15]),{c(){W(e.$$.fragment)},m(t,i){X(e,t,i),n=!0},p(t,n){const i={};1&n&&(i.parentDialogNode=t[0]),e.$set(i)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){G(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function Ct(t){let e,n,i=[],o=new Map,l=t[0].nextNodes;const r=t=>t[25];for(let e=0;e<l.length;e+=1){let n=$t(t,l,e),u=r(n);o.set(u,i[e]=Ot(u,n))}return{c(){e=f("ul");for(let t=0;t<i.length;t+=1)i[t].c();_(e,"is-hidden",!t[6])},m(t,o){c(t,e,o);for(let t=0;t<i.length;t+=1)i[t].m(e,null);n=!0},p(t,n){2055&n&&(l=t[0].nextNodes,B(),i=K(i,n,r,1,t,l,o,e,H,Ot,null,$t),F()),64&n&&_(e,"is-hidden",!t[6])},i(t){if(!n){for(let t=0;t<l.length;t+=1)T(i[t]);n=!0}},o(t){for(let t=0;t<i.length;t+=1)G(i[t]);n=!1},d(t){t&&d(e);for(let t=0;t<i.length;t+=1)i[t].d()}}}function jt(t){let e,n,i;function o(e){t[21](e,t[23])}let l={gender:t[2],language:t[1],parentNodeId:t[0].id};return void 0!==t[11].dialogNodes[t[23]]&&(l.dialogNode=t[11].dialogNodes[t[23]]),e=new Et({props:l}),q.push((()=>Q(e,"dialogNode",o))),{c(){W(e.$$.fragment)},m(t,n){X(e,t,n),i=!0},p(i,o){t=i;const l={};4&o&&(l.gender=t[2]),2&o&&(l.language=t[1]),1&o&&(l.parentNodeId=t[0].id),!n&&2049&o&&(n=!0,l.dialogNode=t[11].dialogNodes[t[23]],M((()=>n=!1))),e.$set(l)},i(t){i||(T(e.$$.fragment,t),i=!0)},o(t){G(e.$$.fragment,t),i=!1},d(t){Y(e,t)}}}function Ot(t,e){let n,i,o,l=e[11].dialogNodes[e[23]]&&jt(e);return{key:t,first:null,c(){n=m(),l&&l.c(),i=m(),this.first=n},m(t,e){c(t,n,e),l&&l.m(t,e),c(t,i,e),o=!0},p(t,n){(e=t)[11].dialogNodes[e[23]]?l?(l.p(e,n),2049&n&&T(l,1)):(l=jt(e),l.c(),T(l,1),l.m(i.parentNode,i)):l&&(B(),G(l,1,1,(()=>{l=null})),F())},i(t){o||(T(l),o=!0)},o(t){G(l),o=!1},d(t){t&&d(n),l&&l.d(t),t&&d(i)}}}function qt(t){let e,n,o,l,r,u,s,m,$,x,y,k,w,C,j,O,q,z,E,S,P,I,A,M,D,L,R,V,U,J,H,K,Q=t[0].character+"",W=t[12](t[0].text)+"",X=(t[5][t[0].id]?.length||0)+"";function Y(t,e){return t[8]?bt:xt}let Z=Y(t),tt=Z(t),et="1"!==t[0].id&&yt(t),nt=t[3]&&t[5][t[0].id]?.length>0&&kt(t),it=t[9]&&_t(t),ot=t[10]&&wt(t),lt=(t[4]||!t[5][t[0].id]||t[5][t[0].id]?.length<=1)&&Ct(t);return{c(){e=f("li"),n=f("div"),o=f("p"),tt.c(),l=h(),r=f("strong"),u=p(Q),s=p(":\n      "),m=f("span"),$=p('"'),x=p(W),y=p('"'),k=h(),w=g("svg"),C=g("use"),j=h(),O=f("span"),q=p("⇶ "),z=p(X),E=p(" -"),P=h(),I=f("span"),A=g("svg"),M=g("use"),D=h(),et&&et.c(),L=h(),nt&&nt.c(),R=h(),it&&it.c(),V=h(),ot&&ot.c(),U=h(),lt&&lt.c(),N(r,"class","svelte-idywcr"),N(m,"class","italic svelte-idywcr"),N(C,"href","assets/sprite_icons.svg#edit"),N(O,"class","is-primary svelte-idywcr"),N(O,"title",S=(t[5][t[0].id]?.length||0)+" répliques mène(nt) à ce noeud"),_(O,"is-hidden",!t[7]),N(M,"href","assets/sprite_icons.svg#plus-square"),N(I,"title","Ajouter une sous-réplique"),N(I,"class","svelte-idywcr"),N(o,"class","svelte-idywcr"),N(n,"class","dialog-node svelte-idywcr"),_(n,"is-player","Player"===t[0].character)},m(i,d){c(i,e,d),a(e,n),a(n,o),tt.m(o,null),a(o,l),a(o,r),a(r,u),a(o,s),a(o,m),a(m,$),a(m,x),a(m,y),a(o,k),a(o,w),a(w,C),a(o,j),a(o,O),a(O,q),a(O,z),a(O,E),a(o,P),a(o,I),a(I,A),a(A,M),a(o,D),et&&et.m(o,null),a(o,L),nt&&nt.m(o,null),a(n,R),it&&it.m(n,null),a(n,V),ot&&ot.m(n,null),a(e,U),lt&&lt.m(e,null),J=!0,H||(K=[v(r,"click",t[13]),v(m,"click",t[13]),v(w,"click",t[14]),v(A,"click",t[15])],H=!0)},p(t,[i]){Z===(Z=Y(t))&&tt?tt.p(t,i):(tt.d(1),tt=Z(t),tt&&(tt.c(),tt.m(o,l))),(!J||1&i)&&Q!==(Q=t[0].character+"")&&b(u,Q),(!J||1&i)&&W!==(W=t[12](t[0].text)+"")&&b(x,W),(!J||33&i)&&X!==(X=(t[5][t[0].id]?.length||0)+"")&&b(z,X),(!J||33&i&&S!==(S=(t[5][t[0].id]?.length||0)+" répliques mène(nt) à ce noeud"))&&N(O,"title",S),128&i&&_(O,"is-hidden",!t[7]),"1"!==t[0].id?et?et.p(t,i):(et=yt(t),et.c(),et.m(o,L)):et&&(et.d(1),et=null),t[3]&&t[5][t[0].id]?.length>0?nt?nt.p(t,i):(nt=kt(t),nt.c(),nt.m(o,null)):nt&&(nt.d(1),nt=null),t[9]?it?(it.p(t,i),512&i&&T(it,1)):(it=_t(t),it.c(),T(it,1),it.m(n,V)):it&&(B(),G(it,1,1,(()=>{it=null})),F()),t[10]?ot?(ot.p(t,i),1024&i&&T(ot,1)):(ot=wt(t),ot.c(),T(ot,1),ot.m(n,null)):ot&&(B(),G(ot,1,1,(()=>{ot=null})),F()),1&i&&_(n,"is-player","Player"===t[0].character),t[4]||!t[5][t[0].id]||t[5][t[0].id]?.length<=1?lt?(lt.p(t,i),49&i&&T(lt,1)):(lt=Ct(t),lt.c(),T(lt,1),lt.m(e,null)):lt&&(B(),G(lt,1,1,(()=>{lt=null})),F())},i(t){J||(T(it),T(ot),T(lt),J=!0)},o(t){G(it),G(ot),G(lt),J=!1},d(t){t&&d(e),tt.d(),et&&et.d(),nt&&nt.d(),it&&it.d(),ot&&ot.d(),lt&&lt.d(),H=!1,i(K)}}}function zt(t,e,n){let i,o;u(t,at,(t=>n(11,i=t))),u(t,mt,(t=>n(5,o=t)));var l,r,a=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,l){function r(t){try{s(i.next(t))}catch(t){l(t)}}function u(t){try{s(i.throw(t))}catch(t){l(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,u)}s((i=i.apply(t,e||[])).next())}))};let{language:c}=e,{gender:d}=e,{dialogNode:f}=e,{parentNodeId:g=null}=e,{renderMultiIncomingVerticesNodeChildren:p=!1}=e,h=!1,m=!1,v=!1,N=!1,$=!1;return t.$$set=t=>{"language"in t&&n(1,c=t.language),"gender"in t&&n(2,d=t.gender),"dialogNode"in t&&n(0,f=t.dialogNode),"parentNodeId"in t&&n(3,g=t.parentNodeId),"renderMultiIncomingVerticesNodeChildren"in t&&n(4,p=t.renderMultiIncomingVerticesNodeChildren)},t.$$.update=()=>{262177&t.$$.dirty&&n(7,m=(null===n(18,l=o[null==f?void 0:f.id])||void 0===l?void 0:l.length)>1||!1),524289&t.$$.dirty&&n(8,v=0===(null===n(19,r=null==f?void 0:f.nextNodes)||void 0===r?void 0:r.length))},[f,c,d,g,p,o,h,m,v,N,$,i,t=>{var e,n;return(null===(e=null==t?void 0:t[c])||void 0===e?void 0:e[d])||(null===(n=null==t?void 0:t[c])||void 0===n?void 0:n.m)||(null==t?void 0:t[c])||t.fr},function(){n(6,h=!h),h||(n(9,N=h),n(10,$=h))},function(){n(9,N=!N),n(6,h=N),N&&n(10,$=!1)},function(t){var e;n(10,$=!$),!1!==(null===(e=null==t?void 0:t.detail)||void 0===e?void 0:e.toggleChildNodes)&&n(6,h=$),$&&n(9,N=!1)},function(){s(at,i.dialogNodes[g].nextNodes=i.dialogNodes[g].nextNodes.filter((t=>t!==f.id)),i)},function(){return a(this,void 0,void 0,(function*(){const t=f.id;delete i.dialogNodes[t],at.set(i),o[t]&&(o[t].forEach((t=>{s(at,i.dialogNodes[t].nextNodes=i.dialogNodes[t].nextNodes.filter((e=>e!==t)),i)})),yield(I(),S))}))},l,r,function(t){f=t,n(0,f)},function(e,n){t.$$.not_equal(i.dialogNodes[n],e)&&(i.dialogNodes[n]=e,at.set(i))}]}class Et extends tt{constructor(t){super(),Z(this,t,zt,qt,l,{language:1,gender:2,dialogNode:0,parentNodeId:3,renderMultiIncomingVerticesNodeChildren:4})}}function St(t,e,n){const i=t.slice();return i[12]=e[n],i[13]=e,i[14]=n,i}function Pt(t,e,n){const i=t.slice();return i[12]=e[n],i[15]=e,i[14]=n,i}function It(e){let n;return{c(){n=f("p"),n.textContent="Veuillez charger un fichier de scénario JSON."},m(t,e){c(t,n,e)},p:t,i:t,o:t,d(t){t&&d(n)}}}function At(t){let e,n,i,o,l,r,u,s,g,m,$,x,y,k,_,w,C=t[1].metadata.part+"",j=t[1].metadata.chapter+"";function O(e){t[7](e)}let z={gender:Ut,language:Jt};return void 0!==t[1].dialogNodes[1]&&(z.dialogNode=t[1].dialogNodes[1]),x=new Et({props:z}),q.push((()=>Q(x,"dialogNode",O))),{c(){e=f("button"),e.textContent="Exporter Scénario",n=h(),i=f("h3"),o=p("Partie "),l=p(C),r=p(": Chapitre "),u=p(j),s=h(),g=f("h4"),g.textContent="Noeud Racine:",m=h(),$=f("ul"),W(x.$$.fragment),N(e,"id","downloadlink"),N(e,"class","svelte-a63f12"),N(g,"class","svelte-a63f12")},m(d,f){c(d,e,f),c(d,n,f),c(d,i,f),a(i,o),a(i,l),a(i,r),a(i,u),c(d,s,f),c(d,g,f),c(d,m,f),c(d,$,f),X(x,$,null),k=!0,_||(w=v(e,"click",t[5]),_=!0)},p(t,e){(!k||2&e)&&C!==(C=t[1].metadata.part+"")&&b(l,C),(!k||2&e)&&j!==(j=t[1].metadata.chapter+"")&&b(u,j);const n={};!y&&2&e&&(y=!0,n.dialogNode=t[1].dialogNodes[1],M((()=>y=!1))),x.$set(n)},i(t){k||(T(x.$$.fragment,t),k=!0)},o(t){G(x.$$.fragment,t),k=!1},d(t){t&&d(e),t&&d(n),t&&d(i),t&&d(s),t&&d(g),t&&d(m),t&&d($),Y(x),_=!1,w()}}}function Mt(t){let e,n,i,o,l=[],r=new Map,u=t[2];const s=t=>t[14];for(let e=0;e<u.length;e+=1){let n=Pt(t,u,e),i=s(n);r.set(i,l[e]=Dt(i,n))}return{c(){e=f("h4"),e.textContent="Noeud(s) à incidences multiples:",n=h(),i=f("ul");for(let t=0;t<l.length;t+=1)l[t].c();N(e,"title","Noeuds liés par plusieurs répliques"),N(e,"class","svelte-a63f12")},m(t,r){c(t,e,r),c(t,n,r),c(t,i,r);for(let t=0;t<l.length;t+=1)l[t].m(i,null);o=!0},p(t,e){6&e&&(u=t[2],B(),l=K(l,e,s,1,t,u,r,i,H,Dt,null,Pt),F())},i(t){if(!o){for(let t=0;t<u.length;t+=1)T(l[t]);o=!0}},o(t){for(let t=0;t<l.length;t+=1)G(l[t]);o=!1},d(t){t&&d(e),t&&d(n),t&&d(i);for(let t=0;t<l.length;t+=1)l[t].d()}}}function Dt(t,e){let n,i,o,l;function r(t){e[8](t,e[12])}let u={gender:Ut,language:Jt,renderMultiIncomingVerticesNodeChildren:!0};return void 0!==e[1].dialogNodes[e[12]]&&(u.dialogNode=e[1].dialogNodes[e[12]]),i=new Et({props:u}),q.push((()=>Q(i,"dialogNode",r))),{key:t,first:null,c(){n=m(),W(i.$$.fragment),this.first=n},m(t,e){c(t,n,e),X(i,t,e),l=!0},p(t,n){e=t;const l={};!o&&6&n&&(o=!0,l.dialogNode=e[1].dialogNodes[e[12]],M((()=>o=!1))),i.$set(l)},i(t){l||(T(i.$$.fragment,t),l=!0)},o(t){G(i.$$.fragment,t),l=!1},d(t){t&&d(n),Y(i,t)}}}function Lt(t){let e,n,i,o,l=[],r=new Map,u=t[3];const s=t=>t[14];for(let e=0;e<u.length;e+=1){let n=St(t,u,e),i=s(n);r.set(i,l[e]=Rt(i,n))}return{c(){e=f("h4"),e.textContent="Noeud(s) orphelin(s):",n=h(),i=f("ul");for(let t=0;t<l.length;t+=1)l[t].c();N(e,"title","Noeuds n'étant la réplique d'aucun autre (et n'étant pas le noeud racine)"),N(e,"class","svelte-a63f12")},m(t,r){c(t,e,r),c(t,n,r),c(t,i,r);for(let t=0;t<l.length;t+=1)l[t].m(i,null);o=!0},p(t,e){10&e&&(u=t[3],B(),l=K(l,e,s,1,t,u,r,i,H,Rt,null,St),F())},i(t){if(!o){for(let t=0;t<u.length;t+=1)T(l[t]);o=!0}},o(t){for(let t=0;t<l.length;t+=1)G(l[t]);o=!1},d(t){t&&d(e),t&&d(n),t&&d(i);for(let t=0;t<l.length;t+=1)l[t].d()}}}function Rt(t,e){let n,i,o,l;function r(t){e[9](t,e[12])}let u={gender:Ut,language:Jt,parentNodeId:"1"};return void 0!==e[1].dialogNodes[e[12]]&&(u.dialogNode=e[1].dialogNodes[e[12]]),i=new Et({props:u}),q.push((()=>Q(i,"dialogNode",r))),{key:t,first:null,c(){n=m(),W(i.$$.fragment),this.first=n},m(t,e){c(t,n,e),X(i,t,e),l=!0},p(t,n){e=t;const l={};!o&&10&n&&(o=!0,l.dialogNode=e[1].dialogNodes[e[12]],M((()=>o=!1))),i.$set(l)},i(t){l||(T(i.$$.fragment,t),l=!0)},o(t){G(i.$$.fragment,t),l=!1},d(t){t&&d(n),Y(i,t)}}}function Vt(t){let e,n,o,l,r,u,s,g,p,m,$,b,x,y,k;const _=[At,It],w=[];function C(t,e){return 2&e&&(g=!!(Object.keys(t[1].dialogNodes).length>0)),g?0:1}p=C(t,-1),m=w[p]=_[p](t);let j=t[2].length>0&&Mt(t),O=t[3].length>0&&Lt(t);return{c(){e=f("main"),n=f("h1"),n.textContent="Auto-Diagnostique",o=h(),l=f("h2"),l.textContent="Outil d'édition de dialogues",r=h(),u=f("input"),s=h(),m.c(),$=h(),j&&j.c(),b=h(),O&&O.c(),N(n,"class","svelte-a63f12"),N(u,"accept","application/json"),N(u,"type","file"),N(u,"id","scenarioFile"),N(e,"class","svelte-a63f12")},m(i,d){c(i,e,d),a(e,n),a(e,o),a(e,l),a(e,r),a(e,u),a(e,s),w[p].m(e,null),a(e,$),j&&j.m(e,null),a(e,b),O&&O.m(e,null),x=!0,y||(k=[v(u,"change",t[6]),v(u,"change",t[4])],y=!0)},p(t,[n]){let i=p;p=C(t,n),p===i?w[p].p(t,n):(B(),G(w[i],1,1,(()=>{w[i]=null})),F(),m=w[p],m?m.p(t,n):(m=w[p]=_[p](t),m.c()),T(m,1),m.m(e,$)),t[2].length>0?j?(j.p(t,n),4&n&&T(j,1)):(j=Mt(t),j.c(),T(j,1),j.m(e,b)):j&&(B(),G(j,1,1,(()=>{j=null})),F()),t[3].length>0?O?(O.p(t,n),8&n&&T(O,1)):(O=Lt(t),O.c(),T(O,1),O.m(e,null)):O&&(B(),G(O,1,1,(()=>{O=null})),F())},i(t){x||(T(m),T(j),T(O),x=!0)},o(t){G(m),G(j),G(O),x=!1},d(t){t&&d(e),w[p].d(),j&&j.d(),O&&O.d(),y=!1,i(k)}}}let Ut="m",Jt="fr";function Bt(t,e,n){let i,o,l;u(t,at,(t=>n(1,i=t))),u(t,Nt,(t=>n(2,o=t))),u(t,vt,(t=>n(3,l=t)));var r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,l){function r(t){try{s(i.next(t))}catch(t){l(t)}}function u(t){try{s(i.throw(t))}catch(t){l(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,u)}s((i=i.apply(t,e||[])).next())}))};let s,a;return[s,i,o,l,function(){return r(this,void 0,void 0,(function*(){const t=yield s[0].text();a=s[0].name,at.set(JSON.parse(t))}))},function(){const t=Object.keys(i.dialogNodes).reduce(((t,e,n)=>Object.assign(Object.assign({},t),{[e]:String(n+1)})),{}),e={metadata:Object.assign({},i.metadata),dialogNodes:Object.assign({},Object.fromEntries(Object.entries(i.dialogNodes).map((([e,n],i)=>{let o=Object.assign({},n);return o.nextNodes=o.nextNodes.map((e=>t[e])),o.id=String(i+1),[i+1,o]}))))},n=document.createElement("a"),o=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),l=URL.createObjectURL(o);n.href=l,n.download=a,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(l)},function(){s=this.files,n(0,s)},function(e){t.$$.not_equal(i.dialogNodes[1],e)&&(i.dialogNodes[1]=e,at.set(i))},function(e,n){t.$$.not_equal(i.dialogNodes[n],e)&&(i.dialogNodes[n]=e,at.set(i))},function(e,n){t.$$.not_equal(i.dialogNodes[n],e)&&(i.dialogNodes[n]=e,at.set(i))}]}return new class extends tt{constructor(t){super(),Z(this,t,Bt,Vt,l,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
