var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function i(t){t.forEach(e)}function o(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function r(e,...n){if(null==e)return t;const i=e.subscribe(...n);return i.unsubscribe?()=>i.unsubscribe():i}function s(t,e,n){t.$$.on_destroy.push(r(e,n))}function u(t,e,n=e){return t.set(n),e}function a(t,e){t.appendChild(e)}function c(t,e,n){t.insertBefore(e,n||null)}function d(t){t.parentNode.removeChild(t)}function f(t){return document.createElement(t)}function g(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function p(t){return document.createTextNode(t)}function h(){return p(" ")}function m(){return p("")}function v(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function N(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function $(t){return""===t?null:+t}function b(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function x(t,e){t.value=null==e?"":e}function y(t,e){for(let n=0;n<t.options.length;n+=1){const i=t.options[n];if(i.__value===e)return void(i.selected=!0)}}function k(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function _(t,e,n){t.classList[n?"add":"remove"](e)}let w;function C(t){w=t}function j(){const t=function(){if(!w)throw new Error("Function called outside component initialization");return w}();return(e,n)=>{const i=t.$$.callbacks[e];if(i){const o=function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(e,n);i.slice().forEach((e=>{e.call(t,o)}))}}}const O=[],q=[],z=[],E=[],S=Promise.resolve();let P=!1;function I(t){z.push(t)}function A(t){E.push(t)}let M=!1;const D=new Set;function L(){if(!M){M=!0;do{for(let t=0;t<O.length;t+=1){const e=O[t];C(e),R(e.$$)}for(C(null),O.length=0;q.length;)q.pop()();for(let t=0;t<z.length;t+=1){const e=z[t];D.has(e)||(D.add(e),e())}z.length=0}while(O.length);for(;E.length;)E.pop()();P=!1,M=!1,D.clear()}}function R(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(I)}}const V=new Set;let U;function J(){U={r:0,c:[],p:U}}function B(){U.r||i(U.c),U=U.p}function F(t,e){t&&t.i&&(V.delete(t),t.i(e))}function T(t,e,n,i){if(t&&t.o){if(V.has(t))return;V.add(t),U.c.push((()=>{V.delete(t),i&&(n&&t.d(1),i())})),t.o(e)}}function G(t,e){T(t,1,1,(()=>{e.delete(t.key)}))}function H(t,e,n,i,o,l,r,s,u,a,c,d){let f=t.length,g=l.length,p=f;const h={};for(;p--;)h[t[p].key]=p;const m=[],v=new Map,N=new Map;for(p=g;p--;){const t=d(o,l,p),s=n(t);let u=r.get(s);u?i&&u.p(t,e):(u=a(s,t),u.c()),v.set(s,m[p]=u),s in h&&N.set(s,Math.abs(p-h[s]))}const $=new Set,b=new Set;function x(t){F(t,1),t.m(s,c),r.set(t.key,t),c=t.first,g--}for(;f&&g;){const e=m[g-1],n=t[f-1],i=e.key,o=n.key;e===n?(c=e.first,f--,g--):v.has(o)?!r.has(i)||$.has(i)?x(e):b.has(o)?f--:N.get(i)>N.get(o)?(b.add(i),x(e)):($.add(o),f--):(u(n,r),f--)}for(;f--;){const e=t[f];v.has(e.key)||u(e,r)}for(;g;)x(m[g-1]);return m}function K(t,e,n){const i=t.$$.props[e];void 0!==i&&(t.$$.bound[i]=n,n(t.$$.ctx[i]))}function Q(t){t&&t.c()}function W(t,n,l,r){const{fragment:s,on_mount:u,on_destroy:a,after_update:c}=t.$$;s&&s.m(n,l),r||I((()=>{const n=u.map(e).filter(o);a?a.push(...n):i(n),t.$$.on_mount=[]})),c.forEach(I)}function X(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Y(t,e){-1===t.$$.dirty[0]&&(O.push(t),P||(P=!0,S.then(L)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Z(e,o,l,r,s,u,a=[-1]){const c=w;C(e);const f=e.$$={fragment:null,ctx:null,props:u,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(c?c.$$.context:o.context||[]),callbacks:n(),dirty:a,skip_bound:!1};let g=!1;if(f.ctx=l?l(e,o.props||{},((t,n,...i)=>{const o=i.length?i[0]:n;return f.ctx&&s(f.ctx[t],f.ctx[t]=o)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](o),g&&Y(e,t)),n})):[],f.update(),g=!0,i(f.before_update),f.fragment=!!r&&r(f.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);f.fragment&&f.fragment.l(t),t.forEach(d)}else f.fragment&&f.fragment.c();o.intro&&F(e.$$.fragment),W(e,o.target,o.anchor,o.customElement),L()}C(c)}class tt{$destroy(){X(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function et(t){let e,n,i;return{c(){e=f("input"),N(e,"type","text"),N(e,"class","svelte-zog1mk")},m(o,l){c(o,e,l),x(e,t[0].text.fr),n||(i=v(e,"input",t[4]),n=!0)},p(t,n){1&n&&e.value!==t[0].text.fr&&x(e,t[0].text.fr)},d(t){t&&d(e),n=!1,i()}}}function nt(t){let e,n,o,l,r,s,u,g,m,$;return{c(){e=f("div"),n=f("p"),o=p("m: "),l=f("input"),r=h(),s=f("p"),u=p("f: "),g=f("input"),N(l,"type","text"),N(l,"class","svelte-zog1mk"),N(n,"class","svelte-zog1mk"),N(g,"type","text"),N(g,"class","svelte-zog1mk"),N(s,"class","svelte-zog1mk"),N(e,"class","details svelte-zog1mk")},m(i,d){c(i,e,d),a(e,n),a(n,o),a(n,l),x(l,t[0].text.fr.m),a(e,r),a(e,s),a(s,u),a(s,g),x(g,t[0].text.fr.f),m||($=[v(l,"input",t[5]),v(g,"input",t[6])],m=!0)},p(t,e){1&e&&l.value!==t[0].text.fr.m&&x(l,t[0].text.fr.m),1&e&&g.value!==t[0].text.fr.f&&x(g,t[0].text.fr.f)},d(t){t&&d(e),m=!1,i($)}}}function it(e){let n,o,l,r,s,u,g,m,b,k,w,C,j,O,q,z,E,S,P,A,M,D,L,R,V,U,J,B,F,T,G,H,K,Q,W,X,Y,Z,tt,it,ot,lt,rt,st,ut,at,ct,dt,ft,gt,pt,ht,mt,vt,Nt,$t,bt,xt,yt,kt="string"==typeof e[0].text.fr&&et(e),_t="object"==typeof e[0].text.fr&&nt(e);return{c(){n=f("div"),o=f("div"),l=p("Protagoniste:\n      "),r=f("select"),s=f("option"),s.textContent="Joueur",u=f("option"),u.textContent="NPC1",g=h(),m=f("div"),b=p("FR:\n    "),kt&&kt.c(),k=h(),w=f("span"),w.textContent="m|f",C=h(),_t&&_t.c(),j=h(),O=f("div"),q=p("EN:\n    "),z=f("input"),E=h(),S=f("div"),P=p("URL Image:\n      "),A=f("input"),M=h(),D=f("div"),L=p("Attributions:\n    "),R=f("div"),V=f("div"),U=f("input"),J=p(" Leader"),B=h(),F=f("div"),T=f("input"),G=p(" Bricoleur"),H=h(),K=f("div"),Q=f("input"),W=p(" Coequipier"),X=h(),Y=f("div"),Z=f("input"),tt=p("Planificateur"),it=h(),ot=f("div"),lt=f("input"),rt=p(" Idealiste"),st=h(),ut=f("div"),at=f("input"),ct=p(" Creatif"),dt=h(),ft=f("div"),gt=f("input"),pt=p("Audacieux"),ht=h(),mt=f("div"),vt=f("input"),Nt=p(" Explorateur"),$t=h(),bt=f("span"),bt.textContent="chiffres entiers positifs ou négatifs",s.__value="Player",s.value=s.__value,u.__value="NPC1",u.value=u.__value,void 0===e[0].character&&I((()=>e[3].call(r))),N(o,"class","mb-3"),N(w,"class","svelte-zog1mk"),_(w,"is-enabled",e[1]),N(m,"class","mb-3"),N(z,"type","text"),N(z,"class","svelte-zog1mk"),N(O,"class","mb-3"),N(A,"type","text"),N(A,"class","svelte-zog1mk"),N(S,"class","mb-3"),N(U,"type","number"),N(U,"class","svelte-zog1mk"),N(T,"type","number"),N(T,"class","svelte-zog1mk"),N(Q,"type","number"),N(Q,"class","svelte-zog1mk"),N(Z,"type","number"),N(Z,"class","svelte-zog1mk"),N(lt,"type","number"),N(lt,"class","svelte-zog1mk"),N(at,"type","number"),N(at,"class","svelte-zog1mk"),N(gt,"type","number"),N(gt,"class","svelte-zog1mk"),N(vt,"type","number"),N(vt,"class","svelte-zog1mk"),N(R,"class","attribution-container svelte-zog1mk"),N(bt,"class","is-small is-italic"),N(n,"class","properties svelte-zog1mk"),_(n,"background-gray","Player"!==e[0].character)},m(t,i){c(t,n,i),a(n,o),a(o,l),a(o,r),a(r,s),a(r,u),y(r,e[0].character),a(n,g),a(n,m),a(m,b),kt&&kt.m(m,null),a(m,k),a(m,w),a(n,C),_t&&_t.m(n,null),a(n,j),a(n,O),a(O,q),a(O,z),x(z,e[0].text.en),a(n,E),a(n,S),a(S,P),a(S,A),x(A,e[0].imagePath),a(n,M),a(n,D),a(D,L),a(D,R),a(R,V),a(V,U),x(U,e[0].attribution.leader),a(V,J),a(R,B),a(R,F),a(F,T),x(T,e[0].attribution.bricoleur),a(F,G),a(R,H),a(R,K),a(K,Q),x(Q,e[0].attribution.coequipier),a(K,W),a(R,X),a(R,Y),a(Y,Z),x(Z,e[0].attribution.planificateur),a(Y,tt),a(R,it),a(R,ot),a(ot,lt),x(lt,e[0].attribution.idealiste),a(ot,rt),a(R,st),a(R,ut),a(ut,at),x(at,e[0].attribution.creatif),a(ut,ct),a(R,dt),a(R,ft),a(ft,gt),x(gt,e[0].attribution.audacieux),a(ft,pt),a(R,ht),a(R,mt),a(mt,vt),x(vt,e[0].attribution.explorateur),a(mt,Nt),a(D,$t),a(D,bt),xt||(yt=[v(r,"change",e[3]),v(w,"click",e[2]),v(z,"input",e[7]),v(A,"input",e[8]),v(U,"input",e[9]),v(T,"input",e[10]),v(Q,"input",e[11]),v(Z,"input",e[12]),v(lt,"input",e[13]),v(at,"input",e[14]),v(gt,"input",e[15]),v(vt,"input",e[16])],xt=!0)},p(t,[e]){1&e&&y(r,t[0].character),"string"==typeof t[0].text.fr?kt?kt.p(t,e):(kt=et(t),kt.c(),kt.m(m,k)):kt&&(kt.d(1),kt=null),2&e&&_(w,"is-enabled",t[1]),"object"==typeof t[0].text.fr?_t?_t.p(t,e):(_t=nt(t),_t.c(),_t.m(n,j)):_t&&(_t.d(1),_t=null),1&e&&z.value!==t[0].text.en&&x(z,t[0].text.en),1&e&&A.value!==t[0].imagePath&&x(A,t[0].imagePath),1&e&&$(U.value)!==t[0].attribution.leader&&x(U,t[0].attribution.leader),1&e&&$(T.value)!==t[0].attribution.bricoleur&&x(T,t[0].attribution.bricoleur),1&e&&$(Q.value)!==t[0].attribution.coequipier&&x(Q,t[0].attribution.coequipier),1&e&&$(Z.value)!==t[0].attribution.planificateur&&x(Z,t[0].attribution.planificateur),1&e&&$(lt.value)!==t[0].attribution.idealiste&&x(lt,t[0].attribution.idealiste),1&e&&$(at.value)!==t[0].attribution.creatif&&x(at,t[0].attribution.creatif),1&e&&$(gt.value)!==t[0].attribution.audacieux&&x(gt,t[0].attribution.audacieux),1&e&&$(vt.value)!==t[0].attribution.explorateur&&x(vt,t[0].attribution.explorateur),1&e&&_(n,"background-gray","Player"!==t[0].character)},i:t,o:t,d(t){t&&d(n),kt&&kt.d(),_t&&_t.d(),xt=!1,i(yt)}}}function ot(t,e,n){let i,{dialogNode:o}=e;return t.$$set=t=>{"dialogNode"in t&&n(0,o=t.dialogNode)},t.$$.update=()=>{1&t.$$.dirty&&n(1,i="object"==typeof o.text.fr)},[o,i,function(){"object"==typeof o.text.fr?n(0,o.text.fr=o.text.fr.m,o):n(0,o.text.fr={m:o.text.fr,f:o.text.fr},o)},function(){o.character=k(this),n(0,o)},function(){o.text.fr=this.value,n(0,o)},function(){o.text.fr.m=this.value,n(0,o)},function(){o.text.fr.f=this.value,n(0,o)},function(){o.text.en=this.value,n(0,o)},function(){o.imagePath=this.value,n(0,o)},function(){o.attribution.leader=$(this.value),n(0,o)},function(){o.attribution.bricoleur=$(this.value),n(0,o)},function(){o.attribution.coequipier=$(this.value),n(0,o)},function(){o.attribution.planificateur=$(this.value),n(0,o)},function(){o.attribution.idealiste=$(this.value),n(0,o)},function(){o.attribution.creatif=$(this.value),n(0,o)},function(){o.attribution.audacieux=$(this.value),n(0,o)},function(){o.attribution.explorateur=$(this.value),n(0,o)}]}class lt extends tt{constructor(t){super(),Z(this,t,ot,it,l,{dialogNode:0})}}const rt=[];function st(e,n=t){let i;const o=[];function r(t){if(l(e,t)&&(e=t,i)){const t=!rt.length;for(let t=0;t<o.length;t+=1){const n=o[t];n[1](),rt.push(n,e)}if(t){for(let t=0;t<rt.length;t+=2)rt[t][0](rt[t+1]);rt.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(l,s=t){const u=[l,s];return o.push(u),1===o.length&&(i=n(r)||t),l(e),()=>{const t=o.indexOf(u);-1!==t&&o.splice(t,1),0===o.length&&(i(),i=null)}}}}function ut(e,n,l){const s=!Array.isArray(e),u=s?[e]:e,a=n.length<2;return{subscribe:st(l,(e=>{let l=!1;const c=[];let d=0,f=t;const g=()=>{if(d)return;f();const i=n(s?c[0]:c,e);a?e(i):f=o(i)?i:t},p=u.map(((t,e)=>r(t,(t=>{c[e]=t,d&=~(1<<e),l&&g()}),(()=>{d|=1<<e}))));return l=!0,g(),function(){i(p),f()}})).subscribe}}const at=st({metadata:{part:"I",chapter:"1"},dialogNodes:{}}),ct=ut(at,(t=>Object.keys(t.dialogNodes).map((e=>{var n,i;return{id:e,text:`#${i=e,`${"0".repeat(5-String(i).length)}${i}`} - ${(null===(n=t.dialogNodes[e].text.fr)||void 0===n?void 0:n.m)||t.dialogNodes[e].text.fr}`}}))));function dt(t,e,n){const i=t.slice();return i[10]=e[n],i}function ft(t){let e,n,i,o,l=t[10].text+"";return{c(){e=f("option"),n=p(l),i=h(),e.__value=o=t[10].id,e.value=e.__value},m(t,o){c(t,e,o),a(e,n),a(e,i)},p(t,i){4&i&&l!==(l=t[10].text+"")&&b(n,l),4&i&&o!==(o=t[10].id)&&(e.__value=o,e.value=e.__value)},d(t){t&&d(e)}}}function gt(t){let e,n,o,l,r,s,u,a,g,p,m,N,$,b,x;function k(e){t[6](e)}let _={};void 0!==t[1]&&(_.dialogNode=t[1]),o=new lt({props:_}),q.push((()=>K(o,"dialogNode",k)));let w=t[2],C=[];for(let e=0;e<w.length;e+=1)C[e]=ft(dt(t,w,e));return{c(){e=f("h5"),e.textContent="Nouvelle réplique",n=h(),Q(o.$$.fragment),r=h(),s=f("button"),s.textContent="Ajouter",u=h(),a=f("h5"),a.textContent="Réplique existante",g=h(),p=f("select");for(let t=0;t<C.length;t+=1)C[t].c();m=h(),N=f("button"),N.textContent="Ajouter",void 0===t[0]&&I((()=>t[7].call(p)))},m(i,l){c(i,e,l),c(i,n,l),W(o,i,l),c(i,r,l),c(i,s,l),c(i,u,l),c(i,a,l),c(i,g,l),c(i,p,l);for(let t=0;t<C.length;t+=1)C[t].m(p,null);y(p,t[0]),c(i,m,l),c(i,N,l),$=!0,b||(x=[v(s,"click",t[4]),v(p,"change",t[7]),v(N,"click",t[3])],b=!0)},p(t,[e]){const n={};if(!l&&2&e&&(l=!0,n.dialogNode=t[1],A((()=>l=!1))),o.$set(n),4&e){let n;for(w=t[2],n=0;n<w.length;n+=1){const i=dt(t,w,n);C[n]?C[n].p(i,e):(C[n]=ft(i),C[n].c(),C[n].m(p,null))}for(;n<C.length;n+=1)C[n].d(1);C.length=w.length}5&e&&y(p,t[0])},i(t){$||(F(o.$$.fragment,t),$=!0)},o(t){T(o.$$.fragment,t),$=!1},d(t){t&&d(e),t&&d(n),X(o,t),t&&d(r),t&&d(s),t&&d(u),t&&d(a),t&&d(g),t&&d(p),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(C,t),t&&d(m),t&&d(N),b=!1,i(x)}}}function pt(t,e,n){let i,o;s(t,at,(t=>n(8,i=t))),s(t,ct,(t=>n(2,o=t)));let l,{parentDialogNode:r}=e,a={id:"",text:{fr:"",en:""},nextNodes:[],character:"NPC1",attribution:{leader:0,bricoleur:0,coequipier:0,planificateur:0,idealiste:0,creatif:0,audacieux:0,explorateur:0}};const c=j();return t.$$set=t=>{"parentDialogNode"in t&&n(5,r=t.parentDialogNode)},[l,a,o,function(){r.nextNodes.includes(l)||n(5,r.nextNodes=[...r.nextNodes,l],r),c("toggleShowNewDialogNode",{toggleChildNodes:!1})},function(){let t=Object.keys(i.dialogNodes).reduce(((t,e)=>Number(e)>t?Number(e):t),1)+1;n(1,a.id=String(t),a),u(at,i.dialogNodes[String(t)]=a,i),n(5,r.nextNodes=[...r.nextNodes,String(t)],r),c("toggleShowNewDialogNode",{toggleChildNodes:!1})},r,function(t){a=t,n(1,a)},function(){l=k(this),n(0,l)}]}class ht extends tt{constructor(t){super(),Z(this,t,pt,gt,l,{parentDialogNode:5})}}const mt=ut(at,(t=>Object.entries(t.dialogNodes).reduce(((t,[e,n])=>(n.nextNodes.forEach((n=>{t[n]=[...t[n]||[],e]})),t)),{}))),vt=ut([at,mt],(t=>Object.keys(t[0].dialogNodes).reduce(((e,n)=>t[1][n]||"1"===n?e:[...e,n]),[]))),Nt=ut([at,mt],(t=>Object.keys(t[0].dialogNodes).reduce(((e,n)=>{var i;return(null===(i=t[1][n])||void 0===i?void 0:i.length)>1?[...e,n]:e}),[])));function $t(t,e,n){const i=t.slice();return i[22]=e[n],i[23]=e,i[24]=n,i}function bt(e){let n;return{c(){n=f("span"),n.textContent="¤",N(n,"title","Noeud terminal"),N(n,"class","svelte-idywcr")},m(t,e){c(t,n,e)},p:t,d(t){t&&d(n)}}}function xt(t){let e,n,o,l,r,s,u,m,$,x,y,k,w,C=t[0].nextNodes.length+"";return{c(){e=g("svg"),n=g("use"),o=h(),l=g("svg"),r=g("use"),s=h(),u=f("span"),m=p("("),$=p(C),x=p(")"),N(n,"href","assets/sprite_icons.svg#angle-double-right"),_(e,"is-hidden",t[5]),N(r,"href","assets/sprite_icons.svg#angle-double-down"),_(l,"is-hidden",!t[5]),N(u,"class","is-primary svelte-idywcr"),N(u,"title",y="Ce noeud mène à "+t[0].nextNodes.length+" réplique(s)")},m(i,d){c(i,e,d),a(e,n),c(i,o,d),c(i,l,d),a(l,r),c(i,s,d),c(i,u,d),a(u,m),a(u,$),a(u,x),k||(w=[v(e,"click",t[12]),v(l,"click",t[12]),v(u,"click",t[12])],k=!0)},p(t,n){32&n&&_(e,"is-hidden",t[5]),32&n&&_(l,"is-hidden",!t[5]),1&n&&C!==(C=t[0].nextNodes.length+"")&&b($,C),1&n&&y!==(y="Ce noeud mène à "+t[0].nextNodes.length+" réplique(s)")&&N(u,"title",y)},d(t){t&&d(e),t&&d(o),t&&d(l),t&&d(s),t&&d(u),k=!1,i(w)}}}function yt(e){let n,i,o,l,r;return{c(){n=f("span"),i=g("svg"),o=g("use"),N(o,"href","assets/sprite_icons.svg#times-circle-solid"),N(i,"class","is-float-right ml-1"),N(n,"title","Supprimer le noeud (irréversible)"),N(n,"class","svelte-idywcr")},m(t,s){c(t,n,s),a(n,i),a(i,o),l||(r=v(i,"click",e[16]),l=!0)},p:t,d(t){t&&d(n),l=!1,r()}}}function kt(e){let n,i,o,l,r;return{c(){n=f("span"),i=g("svg"),o=g("use"),N(o,"href","assets/sprite_icons.svg#times-circle-regular"),N(i,"class","is-float-right"),N(n,"title","Supprimer la filiation (le noeud ne sera pas supprimé, seul son lien avec son noeud parent)"),N(n,"class","svelte-idywcr")},m(t,s){c(t,n,s),a(n,i),a(i,o),l||(r=v(i,"click",e[15]),l=!0)},p:t,d(t){t&&d(n),l=!1,r()}}}function _t(t){let e,n,i;function o(e){t[20](e)}let l={};return void 0!==t[0]&&(l.dialogNode=t[0]),e=new lt({props:l}),q.push((()=>K(e,"dialogNode",o))),{c(){Q(e.$$.fragment)},m(t,n){W(e,t,n),i=!0},p(t,i){const o={};!n&&1&i&&(n=!0,o.dialogNode=t[0],A((()=>n=!1))),e.$set(o)},i(t){i||(F(e.$$.fragment,t),i=!0)},o(t){T(e.$$.fragment,t),i=!1},d(t){X(e,t)}}}function wt(t){let e,n;return e=new ht({props:{parentDialogNode:t[0]}}),e.$on("toggleShowNewDialogNode",t[14]),{c(){Q(e.$$.fragment)},m(t,i){W(e,t,i),n=!0},p(t,n){const i={};1&n&&(i.parentDialogNode=t[0]),e.$set(i)},i(t){n||(F(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){X(e,t)}}}function Ct(t){let e,n,i=[],o=new Map,l=t[0].nextNodes;const r=t=>t[24];for(let e=0;e<l.length;e+=1){let n=$t(t,l,e),s=r(n);o.set(s,i[e]=jt(s,n))}return{c(){e=f("ul");for(let t=0;t<i.length;t+=1)i[t].c();_(e,"is-hidden",!t[5])},m(t,o){c(t,e,o);for(let t=0;t<i.length;t+=1)i[t].m(e,null);n=!0},p(t,n){1031&n&&(l=t[0].nextNodes,J(),i=H(i,n,r,1,t,l,o,e,G,jt,null,$t),B()),32&n&&_(e,"is-hidden",!t[5])},i(t){if(!n){for(let t=0;t<l.length;t+=1)F(i[t]);n=!0}},o(t){for(let t=0;t<i.length;t+=1)T(i[t]);n=!1},d(t){t&&d(e);for(let t=0;t<i.length;t+=1)i[t].d()}}}function jt(t,e){let n,i,o,l;function r(t){e[21](t,e[22])}let s={gender:e[2],language:e[1],parentNodeId:e[0].id};return void 0!==e[10].dialogNodes[e[22]]&&(s.dialogNode=e[10].dialogNodes[e[22]]),i=new zt({props:s}),q.push((()=>K(i,"dialogNode",r))),{key:t,first:null,c(){n=m(),Q(i.$$.fragment),this.first=n},m(t,e){c(t,n,e),W(i,t,e),l=!0},p(t,n){e=t;const l={};4&n&&(l.gender=e[2]),2&n&&(l.language=e[1]),1&n&&(l.parentNodeId=e[0].id),!o&&1025&n&&(o=!0,l.dialogNode=e[10].dialogNodes[e[22]],A((()=>o=!1))),i.$set(l)},i(t){l||(F(i.$$.fragment,t),l=!0)},o(t){T(i.$$.fragment,t),l=!1},d(t){t&&d(n),X(i,t)}}}function Ot(t){let e,n,o,l,r,s,u,m,$,x,y,k,w,C,j,O,q,z,E,S,P,I,A,M,D,L,R,V,U,G,H,K,Q=t[0].character+"",W=t[11](t[0].text)+"",X=(t[4][t[0].id]?.length||0)+"";function Y(t,e){return t[7]?bt:xt}let Z=Y(t),tt=Z(t),et="1"!==t[0].id&&yt(t),nt=t[4][t[0].id]?.length>0&&kt(t),it=t[8]&&_t(t),ot=t[9]&&wt(t),lt=(t[3]||!t[4][t[0].id]||t[4][t[0].id]?.length<=1)&&Ct(t);return{c(){e=f("li"),n=f("div"),o=f("p"),tt.c(),l=h(),r=f("strong"),s=p(Q),u=p(":\n      "),m=f("span"),$=p('"'),x=p(W),y=p('"'),k=h(),w=g("svg"),C=g("use"),j=h(),O=f("span"),q=p("⇶ "),z=p(X),E=p(" -"),P=h(),I=f("span"),A=g("svg"),M=g("use"),D=h(),et&&et.c(),L=h(),nt&&nt.c(),R=h(),it&&it.c(),V=h(),ot&&ot.c(),U=h(),lt&&lt.c(),N(r,"class","svelte-idywcr"),N(m,"class","italic svelte-idywcr"),N(C,"href","assets/sprite_icons.svg#edit"),N(O,"class","is-primary svelte-idywcr"),N(O,"title",S=(t[4][t[0].id]?.length||0)+" répliques mène(nt) à ce noeud"),_(O,"is-hidden",!t[6]),N(M,"href","assets/sprite_icons.svg#plus-square"),N(I,"title","Ajouter une sous-réplique"),N(I,"class","svelte-idywcr"),N(o,"class","svelte-idywcr"),N(n,"class","dialog-node svelte-idywcr"),_(n,"is-player","Player"===t[0].character)},m(i,d){c(i,e,d),a(e,n),a(n,o),tt.m(o,null),a(o,l),a(o,r),a(r,s),a(o,u),a(o,m),a(m,$),a(m,x),a(m,y),a(o,k),a(o,w),a(w,C),a(o,j),a(o,O),a(O,q),a(O,z),a(O,E),a(o,P),a(o,I),a(I,A),a(A,M),a(o,D),et&&et.m(o,null),a(o,L),nt&&nt.m(o,null),a(n,R),it&&it.m(n,null),a(n,V),ot&&ot.m(n,null),a(e,U),lt&&lt.m(e,null),G=!0,H||(K=[v(r,"click",t[12]),v(m,"click",t[12]),v(w,"click",t[13]),v(A,"click",t[14])],H=!0)},p(t,[i]){Z===(Z=Y(t))&&tt?tt.p(t,i):(tt.d(1),tt=Z(t),tt&&(tt.c(),tt.m(o,l))),(!G||1&i)&&Q!==(Q=t[0].character+"")&&b(s,Q),(!G||1&i)&&W!==(W=t[11](t[0].text)+"")&&b(x,W),(!G||17&i)&&X!==(X=(t[4][t[0].id]?.length||0)+"")&&b(z,X),(!G||17&i&&S!==(S=(t[4][t[0].id]?.length||0)+" répliques mène(nt) à ce noeud"))&&N(O,"title",S),64&i&&_(O,"is-hidden",!t[6]),"1"!==t[0].id?et?et.p(t,i):(et=yt(t),et.c(),et.m(o,L)):et&&(et.d(1),et=null),t[4][t[0].id]?.length>0?nt?nt.p(t,i):(nt=kt(t),nt.c(),nt.m(o,null)):nt&&(nt.d(1),nt=null),t[8]?it?(it.p(t,i),256&i&&F(it,1)):(it=_t(t),it.c(),F(it,1),it.m(n,V)):it&&(J(),T(it,1,1,(()=>{it=null})),B()),t[9]?ot?(ot.p(t,i),512&i&&F(ot,1)):(ot=wt(t),ot.c(),F(ot,1),ot.m(n,null)):ot&&(J(),T(ot,1,1,(()=>{ot=null})),B()),1&i&&_(n,"is-player","Player"===t[0].character),t[3]||!t[4][t[0].id]||t[4][t[0].id]?.length<=1?lt?(lt.p(t,i),25&i&&F(lt,1)):(lt=Ct(t),lt.c(),F(lt,1),lt.m(e,null)):lt&&(J(),T(lt,1,1,(()=>{lt=null})),B())},i(t){G||(F(it),F(ot),F(lt),G=!0)},o(t){T(it),T(ot),T(lt),G=!1},d(t){t&&d(e),tt.d(),et&&et.d(),nt&&nt.d(),it&&it.d(),ot&&ot.d(),lt&&lt.d(),H=!1,i(K)}}}function qt(t,e,n){let i,o;var l,r;s(t,at,(t=>n(10,i=t))),s(t,mt,(t=>n(4,o=t)));let{language:a}=e,{gender:c}=e,{dialogNode:d}=e,{parentNodeId:f="1"}=e,{renderMultiIncomingVerticesNodeChildren:g=!1}=e,p=!1,h=!1,m=!1,v=!1,N=!1;return t.$$set=t=>{"language"in t&&n(1,a=t.language),"gender"in t&&n(2,c=t.gender),"dialogNode"in t&&n(0,d=t.dialogNode),"parentNodeId"in t&&n(17,f=t.parentNodeId),"renderMultiIncomingVerticesNodeChildren"in t&&n(3,g=t.renderMultiIncomingVerticesNodeChildren)},t.$$.update=()=>{262161&t.$$.dirty&&n(6,h=(null===n(18,l=o[null==d?void 0:d.id])||void 0===l?void 0:l.length)>1||!1),524289&t.$$.dirty&&n(7,m=0===(null===n(19,r=null==d?void 0:d.nextNodes)||void 0===r?void 0:r.length))},[d,a,c,g,o,p,h,m,v,N,i,t=>{var e,n;return(null===(e=null==t?void 0:t[a])||void 0===e?void 0:e[c])||(null===(n=null==t?void 0:t[a])||void 0===n?void 0:n.m)||(null==t?void 0:t[a])||t.fr},function(){n(5,p=!p),p||(n(8,v=p),n(9,N=p))},function(){n(8,v=!v),n(5,p=v),v&&n(9,N=!1)},function(t){var e;n(9,N=!N),!1!==(null===(e=null==t?void 0:t.detail)||void 0===e?void 0:e.toggleChildNodes)&&n(5,p=N),N&&n(8,v=!1)},function(){u(at,i.dialogNodes[f].nextNodes=i.dialogNodes[f].nextNodes.filter((t=>t!==d.id)),i)},function(){o[d.id].forEach((t=>{u(at,i.dialogNodes[t].nextNodes=i.dialogNodes[t].nextNodes.filter((t=>t!==d.id)),i)})),delete i.dialogNodes[d.id]},f,l,r,function(t){d=t,n(0,d)},function(e,n){t.$$.not_equal(i.dialogNodes[n],e)&&(i.dialogNodes[n]=e,at.set(i))}]}class zt extends tt{constructor(t){super(),Z(this,t,qt,Ot,l,{language:1,gender:2,dialogNode:0,parentNodeId:17,renderMultiIncomingVerticesNodeChildren:3})}}function Et(t,e,n){const i=t.slice();return i[12]=e[n],i[13]=e,i[14]=n,i}function St(t,e,n){const i=t.slice();return i[12]=e[n],i[15]=e,i[14]=n,i}function Pt(e){let n;return{c(){n=f("p"),n.textContent="Veuillez charger un fichier de scénario JSON."},m(t,e){c(t,n,e)},p:t,i:t,o:t,d(t){t&&d(n)}}}function It(t){let e,n,i,o,l,r,s,u,g,m,$,x,y,k,_,w,C=t[1].metadata.part+"",j=t[1].metadata.chapter+"";function O(e){t[7](e)}let z={gender:Vt,language:Ut};return void 0!==t[1].dialogNodes[1]&&(z.dialogNode=t[1].dialogNodes[1]),x=new zt({props:z}),q.push((()=>K(x,"dialogNode",O))),{c(){e=f("button"),e.textContent="Exporter Scénario",n=h(),i=f("h3"),o=p("Partie "),l=p(C),r=p(": Chapitre "),s=p(j),u=h(),g=f("h4"),g.textContent="Noeud Racine:",m=h(),$=f("ul"),Q(x.$$.fragment),N(e,"id","downloadlink"),N(e,"class","svelte-a63f12"),N(g,"class","svelte-a63f12")},m(d,f){c(d,e,f),c(d,n,f),c(d,i,f),a(i,o),a(i,l),a(i,r),a(i,s),c(d,u,f),c(d,g,f),c(d,m,f),c(d,$,f),W(x,$,null),k=!0,_||(w=v(e,"click",t[5]),_=!0)},p(t,e){(!k||2&e)&&C!==(C=t[1].metadata.part+"")&&b(l,C),(!k||2&e)&&j!==(j=t[1].metadata.chapter+"")&&b(s,j);const n={};!y&&2&e&&(y=!0,n.dialogNode=t[1].dialogNodes[1],A((()=>y=!1))),x.$set(n)},i(t){k||(F(x.$$.fragment,t),k=!0)},o(t){T(x.$$.fragment,t),k=!1},d(t){t&&d(e),t&&d(n),t&&d(i),t&&d(u),t&&d(g),t&&d(m),t&&d($),X(x),_=!1,w()}}}function At(t){let e,n,i,o,l=[],r=new Map,s=t[2];const u=t=>t[14];for(let e=0;e<s.length;e+=1){let n=St(t,s,e),i=u(n);r.set(i,l[e]=Mt(i,n))}return{c(){e=f("h4"),e.textContent="Noeud(s) à incidences multiples:",n=h(),i=f("ul");for(let t=0;t<l.length;t+=1)l[t].c();N(e,"title","Noeuds liés par plusieurs répliques"),N(e,"class","svelte-a63f12")},m(t,r){c(t,e,r),c(t,n,r),c(t,i,r);for(let t=0;t<l.length;t+=1)l[t].m(i,null);o=!0},p(t,e){6&e&&(s=t[2],J(),l=H(l,e,u,1,t,s,r,i,G,Mt,null,St),B())},i(t){if(!o){for(let t=0;t<s.length;t+=1)F(l[t]);o=!0}},o(t){for(let t=0;t<l.length;t+=1)T(l[t]);o=!1},d(t){t&&d(e),t&&d(n),t&&d(i);for(let t=0;t<l.length;t+=1)l[t].d()}}}function Mt(t,e){let n,i,o,l;function r(t){e[8](t,e[12])}let s={gender:Vt,language:Ut,renderMultiIncomingVerticesNodeChildren:!0};return void 0!==e[1].dialogNodes[e[12]]&&(s.dialogNode=e[1].dialogNodes[e[12]]),i=new zt({props:s}),q.push((()=>K(i,"dialogNode",r))),{key:t,first:null,c(){n=m(),Q(i.$$.fragment),this.first=n},m(t,e){c(t,n,e),W(i,t,e),l=!0},p(t,n){e=t;const l={};!o&&6&n&&(o=!0,l.dialogNode=e[1].dialogNodes[e[12]],A((()=>o=!1))),i.$set(l)},i(t){l||(F(i.$$.fragment,t),l=!0)},o(t){T(i.$$.fragment,t),l=!1},d(t){t&&d(n),X(i,t)}}}function Dt(t){let e,n,i,o,l=[],r=new Map,s=t[3];const u=t=>t[14];for(let e=0;e<s.length;e+=1){let n=Et(t,s,e),i=u(n);r.set(i,l[e]=Lt(i,n))}return{c(){e=f("h4"),e.textContent="Noeud(s) orphelin(s):",n=h(),i=f("ul");for(let t=0;t<l.length;t+=1)l[t].c();N(e,"title","Noeuds n'étant la réplique d'aucun autre (et n'étant pas le noeud racine)"),N(e,"class","svelte-a63f12")},m(t,r){c(t,e,r),c(t,n,r),c(t,i,r);for(let t=0;t<l.length;t+=1)l[t].m(i,null);o=!0},p(t,e){10&e&&(s=t[3],J(),l=H(l,e,u,1,t,s,r,i,G,Lt,null,Et),B())},i(t){if(!o){for(let t=0;t<s.length;t+=1)F(l[t]);o=!0}},o(t){for(let t=0;t<l.length;t+=1)T(l[t]);o=!1},d(t){t&&d(e),t&&d(n),t&&d(i);for(let t=0;t<l.length;t+=1)l[t].d()}}}function Lt(t,e){let n,i,o,l;function r(t){e[9](t,e[12])}let s={gender:Vt,language:Ut,parentNodeId:"1"};return void 0!==e[1].dialogNodes[e[12]]&&(s.dialogNode=e[1].dialogNodes[e[12]]),i=new zt({props:s}),q.push((()=>K(i,"dialogNode",r))),{key:t,first:null,c(){n=m(),Q(i.$$.fragment),this.first=n},m(t,e){c(t,n,e),W(i,t,e),l=!0},p(t,n){e=t;const l={};!o&&10&n&&(o=!0,l.dialogNode=e[1].dialogNodes[e[12]],A((()=>o=!1))),i.$set(l)},i(t){l||(F(i.$$.fragment,t),l=!0)},o(t){T(i.$$.fragment,t),l=!1},d(t){t&&d(n),X(i,t)}}}function Rt(t){let e,n,o,l,r,s,u,g,p,m,$,b,x,y,k;const _=[It,Pt],w=[];function C(t,e){return 2&e&&(g=!!(Object.keys(t[1].dialogNodes).length>0)),g?0:1}p=C(t,-1),m=w[p]=_[p](t);let j=t[2].length>0&&At(t),O=t[3].length>0&&Dt(t);return{c(){e=f("main"),n=f("h1"),n.textContent="Auto-Diagnostique",o=h(),l=f("h2"),l.textContent="Outil d'édition de dialogues",r=h(),s=f("input"),u=h(),m.c(),$=h(),j&&j.c(),b=h(),O&&O.c(),N(n,"class","svelte-a63f12"),N(s,"accept","application/json"),N(s,"type","file"),N(s,"id","scenarioFile"),N(e,"class","svelte-a63f12")},m(i,d){c(i,e,d),a(e,n),a(e,o),a(e,l),a(e,r),a(e,s),a(e,u),w[p].m(e,null),a(e,$),j&&j.m(e,null),a(e,b),O&&O.m(e,null),x=!0,y||(k=[v(s,"change",t[6]),v(s,"change",t[4])],y=!0)},p(t,[n]){let i=p;p=C(t,n),p===i?w[p].p(t,n):(J(),T(w[i],1,1,(()=>{w[i]=null})),B(),m=w[p],m?m.p(t,n):(m=w[p]=_[p](t),m.c()),F(m,1),m.m(e,$)),t[2].length>0?j?(j.p(t,n),4&n&&F(j,1)):(j=At(t),j.c(),F(j,1),j.m(e,b)):j&&(J(),T(j,1,1,(()=>{j=null})),B()),t[3].length>0?O?(O.p(t,n),8&n&&F(O,1)):(O=Dt(t),O.c(),F(O,1),O.m(e,null)):O&&(J(),T(O,1,1,(()=>{O=null})),B())},i(t){x||(F(m),F(j),F(O),x=!0)},o(t){T(m),T(j),T(O),x=!1},d(t){t&&d(e),w[p].d(),j&&j.d(),O&&O.d(),y=!1,i(k)}}}let Vt="m",Ut="fr";function Jt(t,e,n){let i,o,l;s(t,at,(t=>n(1,i=t))),s(t,Nt,(t=>n(2,o=t))),s(t,vt,(t=>n(3,l=t)));var r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,l){function r(t){try{u(i.next(t))}catch(t){l(t)}}function s(t){try{u(i.throw(t))}catch(t){l(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,s)}u((i=i.apply(t,e||[])).next())}))};let u,a;return[u,i,o,l,function(){return r(this,void 0,void 0,(function*(){const t=yield u[0].text();a=u[0].name,at.set(JSON.parse(t))}))},function(){const t=Object.keys(i.dialogNodes).reduce(((t,e,n)=>Object.assign(Object.assign({},t),{[e]:String(n+1)})),{}),e={metadata:Object.assign({},i.metadata),dialogNodes:Object.assign({},Object.fromEntries(Object.entries(i.dialogNodes).map((([e,n],i)=>{let o=Object.assign({},n);return o.nextNodes=o.nextNodes.map((e=>t[e])),o.id=String(i+1),[i+1,o]}))))},n=document.createElement("a"),o=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),l=URL.createObjectURL(o);n.href=l,n.download=a,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(l)},function(){u=this.files,n(0,u)},function(e){t.$$.not_equal(i.dialogNodes[1],e)&&(i.dialogNodes[1]=e,at.set(i))},function(e,n){t.$$.not_equal(i.dialogNodes[n],e)&&(i.dialogNodes[n]=e,at.set(i))},function(e,n){t.$$.not_equal(i.dialogNodes[n],e)&&(i.dialogNodes[n]=e,at.set(i))}]}return new class extends tt{constructor(t){super(),Z(this,t,Jt,Rt,l,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
