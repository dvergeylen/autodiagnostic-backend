var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function o(e){e.forEach(t)}function i(e){return"function"==typeof e}function l(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function r(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function s(e,t,n){e.$$.on_destroy.push(r(t,n))}function a(e,t,n=t){return e.set(n),t}function u(e,t){e.appendChild(t)}function c(e,t,n){e.insertBefore(t,n||null)}function d(e){e.parentNode.removeChild(e)}function g(e){return document.createElement(e)}function f(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function p(e){return document.createTextNode(e)}function h(){return p(" ")}function m(){return p("")}function v(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function N(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function $(e){return""===e?null:+e}function b(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function x(e,t){e.value=null==t?"":t}function y(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}}function k(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function _(e,t,n){e.classList[n?"add":"remove"](t)}let w;function C(e){w=e}function j(){const e=function(){if(!w)throw new Error("Function called outside component initialization");return w}();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const i=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);o.slice().forEach((t=>{t.call(e,i)}))}}}function O(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}const E=[],q=[],S=[],z=[],L=Promise.resolve();let P=!1;function A(e){S.push(e)}function D(e){z.push(e)}let I=!1;const R=new Set;function M(){if(!I){I=!0;do{for(let e=0;e<E.length;e+=1){const t=E[e];C(t),U(t.$$)}for(C(null),E.length=0;q.length;)q.pop()();for(let e=0;e<S.length;e+=1){const t=S[e];R.has(t)||(R.add(t),t())}S.length=0}while(E.length);for(;z.length;)z.pop()();P=!1,I=!1,R.clear()}}function U(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(A)}}const J=new Set;let B;function F(){B={r:0,c:[],p:B}}function T(){B.r||o(B.c),B=B.p}function V(e,t){e&&e.i&&(J.delete(e),e.i(t))}function G(e,t,n,o){if(e&&e.o){if(J.has(e))return;J.add(e),B.c.push((()=>{J.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}}function H(e,t){G(e,1,1,(()=>{t.delete(e.key)}))}function K(e,t,n,o,i,l,r,s,a,u,c,d){let g=e.length,f=l.length,p=g;const h={};for(;p--;)h[e[p].key]=p;const m=[],v=new Map,N=new Map;for(p=f;p--;){const e=d(i,l,p),s=n(e);let a=r.get(s);a?o&&a.p(e,t):(a=u(s,e),a.c()),v.set(s,m[p]=a),s in h&&N.set(s,Math.abs(p-h[s]))}const $=new Set,b=new Set;function x(e){V(e,1),e.m(s,c),r.set(e.key,e),c=e.first,f--}for(;g&&f;){const t=m[f-1],n=e[g-1],o=t.key,i=n.key;t===n?(c=t.first,g--,f--):v.has(i)?!r.has(o)||$.has(o)?x(t):b.has(i)?g--:N.get(o)>N.get(i)?(b.add(o),x(t)):($.add(i),g--):(a(n,r),g--)}for(;g--;){const t=e[g];v.has(t.key)||a(t,r)}for(;f;)x(m[f-1]);return m}function Q(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function W(e){e&&e.c()}function X(e,n,l,r){const{fragment:s,on_mount:a,on_destroy:u,after_update:c}=e.$$;s&&s.m(n,l),r||A((()=>{const n=a.map(t).filter(i);u?u.push(...n):o(n),e.$$.on_mount=[]})),c.forEach(A)}function Y(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Z(e,t){-1===e.$$.dirty[0]&&(E.push(e),P||(P=!0,L.then(M)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ee(t,i,l,r,s,a,u=[-1]){const c=w;C(t);const g=t.$$={fragment:null,ctx:null,props:a,update:e,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(c?c.$$.context:i.context||[]),callbacks:n(),dirty:u,skip_bound:!1};let f=!1;if(g.ctx=l?l(t,i.props||{},((e,n,...o)=>{const i=o.length?o[0]:n;return g.ctx&&s(g.ctx[e],g.ctx[e]=i)&&(!g.skip_bound&&g.bound[e]&&g.bound[e](i),f&&Z(t,e)),n})):[],g.update(),f=!0,o(g.before_update),g.fragment=!!r&&r(g.ctx),i.target){if(i.hydrate){const e=function(e){return Array.from(e.childNodes)}(i.target);g.fragment&&g.fragment.l(e),e.forEach(d)}else g.fragment&&g.fragment.c();i.intro&&V(t.$$.fragment),X(t,i.target,i.anchor,i.customElement),M()}C(c)}class te{$destroy(){Y(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function ne(e){let t,n,o;return{c(){t=g("input"),N(t,"type","text"),N(t,"class","svelte-zog1mk")},m(i,l){c(i,t,l),x(t,e[0].text.fr),n||(o=v(t,"input",e[4]),n=!0)},p(e,n){1&n&&t.value!==e[0].text.fr&&x(t,e[0].text.fr)},d(e){e&&d(t),n=!1,o()}}}function oe(e){let t,n,i,l,r,s,a,f,m,$;return{c(){t=g("div"),n=g("p"),i=p("m: "),l=g("input"),r=h(),s=g("p"),a=p("f: "),f=g("input"),N(l,"type","text"),N(l,"class","svelte-zog1mk"),N(n,"class","svelte-zog1mk"),N(f,"type","text"),N(f,"class","svelte-zog1mk"),N(s,"class","svelte-zog1mk"),N(t,"class","details svelte-zog1mk")},m(o,d){c(o,t,d),u(t,n),u(n,i),u(n,l),x(l,e[0].text.fr.m),u(t,r),u(t,s),u(s,a),u(s,f),x(f,e[0].text.fr.f),m||($=[v(l,"input",e[5]),v(f,"input",e[6])],m=!0)},p(e,t){1&t&&l.value!==e[0].text.fr.m&&x(l,e[0].text.fr.m),1&t&&f.value!==e[0].text.fr.f&&x(f,e[0].text.fr.f)},d(e){e&&d(t),m=!1,o($)}}}function ie(t){let n,i,l,r,s,a,f,m,b,k,w,C,j,O,E,q,S,z,L,P,D,I,R,M,U,J,B,F,T,V,G,H,K,Q,W,X,Y,Z,ee,te,ie,le,re,se,ae,ue,ce,de,ge,fe,pe,he,me,ve,Ne,$e,be,xe,ye,ke="string"==typeof t[0].text.fr&&ne(t),_e="object"==typeof t[0].text.fr&&oe(t);return{c(){n=g("div"),i=g("div"),l=p("Protagoniste:\n      "),r=g("select"),s=g("option"),s.textContent="Joueur",a=g("option"),a.textContent="NPC1",f=h(),m=g("div"),b=p("FR:\n    "),ke&&ke.c(),k=h(),w=g("span"),w.textContent="m|f",C=h(),_e&&_e.c(),j=h(),O=g("div"),E=p("EN:\n    "),q=g("input"),S=h(),z=g("div"),L=p("URL Image:\n      "),P=g("input"),D=h(),I=g("div"),R=p("Attributions:\n    "),M=g("div"),U=g("div"),J=g("input"),B=p(" Leader"),F=h(),T=g("div"),V=g("input"),G=p(" Bricoleur"),H=h(),K=g("div"),Q=g("input"),W=p(" Coequipier"),X=h(),Y=g("div"),Z=g("input"),ee=p("Planificateur"),te=h(),ie=g("div"),le=g("input"),re=p(" Idealiste"),se=h(),ae=g("div"),ue=g("input"),ce=p(" Creatif"),de=h(),ge=g("div"),fe=g("input"),pe=p("Audacieux"),he=h(),me=g("div"),ve=g("input"),Ne=p(" Explorateur"),$e=h(),be=g("span"),be.textContent="chiffres entiers positifs ou négatifs",s.__value="Player",s.value=s.__value,a.__value="NPC1",a.value=a.__value,void 0===t[0].character&&A((()=>t[3].call(r))),N(i,"class","mb-3"),N(w,"class","svelte-zog1mk"),_(w,"is-enabled",t[1]),N(m,"class","mb-3"),N(q,"type","text"),N(q,"class","svelte-zog1mk"),N(O,"class","mb-3"),N(P,"type","text"),N(P,"class","svelte-zog1mk"),N(z,"class","mb-3"),N(J,"type","number"),N(J,"class","svelte-zog1mk"),N(V,"type","number"),N(V,"class","svelte-zog1mk"),N(Q,"type","number"),N(Q,"class","svelte-zog1mk"),N(Z,"type","number"),N(Z,"class","svelte-zog1mk"),N(le,"type","number"),N(le,"class","svelte-zog1mk"),N(ue,"type","number"),N(ue,"class","svelte-zog1mk"),N(fe,"type","number"),N(fe,"class","svelte-zog1mk"),N(ve,"type","number"),N(ve,"class","svelte-zog1mk"),N(M,"class","attribution-container svelte-zog1mk"),N(be,"class","is-small is-italic"),N(n,"class","properties svelte-zog1mk"),_(n,"background-gray","Player"!==t[0].character)},m(e,o){c(e,n,o),u(n,i),u(i,l),u(i,r),u(r,s),u(r,a),y(r,t[0].character),u(n,f),u(n,m),u(m,b),ke&&ke.m(m,null),u(m,k),u(m,w),u(n,C),_e&&_e.m(n,null),u(n,j),u(n,O),u(O,E),u(O,q),x(q,t[0].text.en),u(n,S),u(n,z),u(z,L),u(z,P),x(P,t[0].imagePath),u(n,D),u(n,I),u(I,R),u(I,M),u(M,U),u(U,J),x(J,t[0].attribution.leader),u(U,B),u(M,F),u(M,T),u(T,V),x(V,t[0].attribution.bricoleur),u(T,G),u(M,H),u(M,K),u(K,Q),x(Q,t[0].attribution.coequipier),u(K,W),u(M,X),u(M,Y),u(Y,Z),x(Z,t[0].attribution.planificateur),u(Y,ee),u(M,te),u(M,ie),u(ie,le),x(le,t[0].attribution.idealiste),u(ie,re),u(M,se),u(M,ae),u(ae,ue),x(ue,t[0].attribution.creatif),u(ae,ce),u(M,de),u(M,ge),u(ge,fe),x(fe,t[0].attribution.audacieux),u(ge,pe),u(M,he),u(M,me),u(me,ve),x(ve,t[0].attribution.explorateur),u(me,Ne),u(I,$e),u(I,be),xe||(ye=[v(r,"change",t[3]),v(w,"click",t[2]),v(q,"input",t[7]),v(P,"input",t[8]),v(J,"input",t[9]),v(V,"input",t[10]),v(Q,"input",t[11]),v(Z,"input",t[12]),v(le,"input",t[13]),v(ue,"input",t[14]),v(fe,"input",t[15]),v(ve,"input",t[16])],xe=!0)},p(e,[t]){1&t&&y(r,e[0].character),"string"==typeof e[0].text.fr?ke?ke.p(e,t):(ke=ne(e),ke.c(),ke.m(m,k)):ke&&(ke.d(1),ke=null),2&t&&_(w,"is-enabled",e[1]),"object"==typeof e[0].text.fr?_e?_e.p(e,t):(_e=oe(e),_e.c(),_e.m(n,j)):_e&&(_e.d(1),_e=null),1&t&&q.value!==e[0].text.en&&x(q,e[0].text.en),1&t&&P.value!==e[0].imagePath&&x(P,e[0].imagePath),1&t&&$(J.value)!==e[0].attribution.leader&&x(J,e[0].attribution.leader),1&t&&$(V.value)!==e[0].attribution.bricoleur&&x(V,e[0].attribution.bricoleur),1&t&&$(Q.value)!==e[0].attribution.coequipier&&x(Q,e[0].attribution.coequipier),1&t&&$(Z.value)!==e[0].attribution.planificateur&&x(Z,e[0].attribution.planificateur),1&t&&$(le.value)!==e[0].attribution.idealiste&&x(le,e[0].attribution.idealiste),1&t&&$(ue.value)!==e[0].attribution.creatif&&x(ue,e[0].attribution.creatif),1&t&&$(fe.value)!==e[0].attribution.audacieux&&x(fe,e[0].attribution.audacieux),1&t&&$(ve.value)!==e[0].attribution.explorateur&&x(ve,e[0].attribution.explorateur),1&t&&_(n,"background-gray","Player"!==e[0].character)},i:e,o:e,d(e){e&&d(n),ke&&ke.d(),_e&&_e.d(),xe=!1,o(ye)}}}function le(e,t,n){let o,{dialogNode:i}=t;return e.$$set=e=>{"dialogNode"in e&&n(0,i=e.dialogNode)},e.$$.update=()=>{1&e.$$.dirty&&n(1,o="object"==typeof i.text.fr)},[i,o,function(){"object"==typeof i.text.fr?n(0,i.text.fr=i.text.fr.m,i):n(0,i.text.fr={m:i.text.fr,f:i.text.fr},i)},function(){i.character=k(this),n(0,i)},function(){i.text.fr=this.value,n(0,i)},function(){i.text.fr.m=this.value,n(0,i)},function(){i.text.fr.f=this.value,n(0,i)},function(){i.text.en=this.value,n(0,i)},function(){i.imagePath=this.value,n(0,i)},function(){i.attribution.leader=$(this.value),n(0,i)},function(){i.attribution.bricoleur=$(this.value),n(0,i)},function(){i.attribution.coequipier=$(this.value),n(0,i)},function(){i.attribution.planificateur=$(this.value),n(0,i)},function(){i.attribution.idealiste=$(this.value),n(0,i)},function(){i.attribution.creatif=$(this.value),n(0,i)},function(){i.attribution.audacieux=$(this.value),n(0,i)},function(){i.attribution.explorateur=$(this.value),n(0,i)}]}class re extends te{constructor(e){super(),ee(this,e,le,ie,l,{dialogNode:0})}}const se=[];function ae(t,n=e){let o;const i=[];function r(e){if(l(t,e)&&(t=e,o)){const e=!se.length;for(let e=0;e<i.length;e+=1){const n=i[e];n[1](),se.push(n,t)}if(e){for(let e=0;e<se.length;e+=2)se[e][0](se[e+1]);se.length=0}}}return{set:r,update:function(e){r(e(t))},subscribe:function(l,s=e){const a=[l,s];return i.push(a),1===i.length&&(o=n(r)||e),l(t),()=>{const e=i.indexOf(a);-1!==e&&i.splice(e,1),0===i.length&&(o(),o=null)}}}}const ue=ae({metadata:{part:"I",chapter:"1"},dialogNodes:{}}),ce=function(t,n,l){const s=!Array.isArray(t),a=s?[t]:t,u=n.length<2;return{subscribe:ae(l,(t=>{let l=!1;const c=[];let d=0,g=e;const f=()=>{if(d)return;g();const o=n(s?c[0]:c,t);u?t(o):g=i(o)?o:e},p=a.map(((e,t)=>r(e,(e=>{c[t]=e,d&=~(1<<t),l&&f()}),(()=>{d|=1<<t}))));return l=!0,f(),function(){o(p),g()}})).subscribe}}(ue,(e=>Object.keys(e.dialogNodes).map((t=>{var n,o;return{id:t,text:`#${o=t,`${"0".repeat(5-String(o).length)}${o}`} - ${(null===(n=e.dialogNodes[t].text.fr)||void 0===n?void 0:n.m)||e.dialogNodes[t].text.fr}`}}))));function de(e,t,n){const o=e.slice();return o[10]=t[n],o}function ge(e){let t,n,o,i,l=e[10].text+"";return{c(){t=g("option"),n=p(l),o=h(),t.__value=i=e[10].id,t.value=t.__value},m(e,i){c(e,t,i),u(t,n),u(t,o)},p(e,o){4&o&&l!==(l=e[10].text+"")&&b(n,l),4&o&&i!==(i=e[10].id)&&(t.__value=i,t.value=t.__value)},d(e){e&&d(t)}}}function fe(e){let t,n,i,l,r,s,a,u,f,p,m,N,$,b,x;function k(t){e[6](t)}let _={};void 0!==e[1]&&(_.dialogNode=e[1]),i=new re({props:_}),q.push((()=>Q(i,"dialogNode",k)));let w=e[2],C=[];for(let t=0;t<w.length;t+=1)C[t]=ge(de(e,w,t));return{c(){t=g("h5"),t.textContent="Nouvelle réplique",n=h(),W(i.$$.fragment),r=h(),s=g("button"),s.textContent="Ajouter",a=h(),u=g("h5"),u.textContent="Réplique existante",f=h(),p=g("select");for(let e=0;e<C.length;e+=1)C[e].c();m=h(),N=g("button"),N.textContent="Ajouter",void 0===e[0]&&A((()=>e[7].call(p)))},m(o,l){c(o,t,l),c(o,n,l),X(i,o,l),c(o,r,l),c(o,s,l),c(o,a,l),c(o,u,l),c(o,f,l),c(o,p,l);for(let e=0;e<C.length;e+=1)C[e].m(p,null);y(p,e[0]),c(o,m,l),c(o,N,l),$=!0,b||(x=[v(s,"click",e[4]),v(p,"change",e[7]),v(N,"click",e[3])],b=!0)},p(e,[t]){const n={};if(!l&&2&t&&(l=!0,n.dialogNode=e[1],D((()=>l=!1))),i.$set(n),4&t){let n;for(w=e[2],n=0;n<w.length;n+=1){const o=de(e,w,n);C[n]?C[n].p(o,t):(C[n]=ge(o),C[n].c(),C[n].m(p,null))}for(;n<C.length;n+=1)C[n].d(1);C.length=w.length}5&t&&y(p,e[0])},i(e){$||(V(i.$$.fragment,e),$=!0)},o(e){G(i.$$.fragment,e),$=!1},d(e){e&&d(t),e&&d(n),Y(i,e),e&&d(r),e&&d(s),e&&d(a),e&&d(u),e&&d(f),e&&d(p),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(C,e),e&&d(m),e&&d(N),b=!1,o(x)}}}function pe(e,t,n){let o,i;s(e,ue,(e=>n(8,o=e))),s(e,ce,(e=>n(2,i=e)));let l,{parentDialogNode:r}=t,u={id:"",text:{fr:"",en:""},nextNodes:[],character:"NPC1",attribution:{leader:0,bricoleur:0,coequipier:0,planificateur:0,idealiste:0,creatif:0,audacieux:0,explorateur:0}};const c=j();return e.$$set=e=>{"parentDialogNode"in e&&n(5,r=e.parentDialogNode)},[l,u,i,function(){r.nextNodes.includes(l)||n(5,r.nextNodes=[...r.nextNodes,l],r),c("updateNodeLists",{}),c("toggleShowNewDialogNode",{toggleChildNodes:!1})},function(){const e=Object.keys(o.dialogNodes);let t=Number(e.reduce(((e,t)=>t>e?t:e),"1"))+1;for(;e.includes(String(t)););n(1,u.id=String(t),u),a(ue,o.dialogNodes[String(t)]=u,o),n(5,r.nextNodes=[...r.nextNodes,String(t)],r),c("updateNodeLists",{}),c("toggleShowNewDialogNode",{toggleChildNodes:!1})},r,function(e){u=e,n(1,u)},function(){l=k(this),n(0,l)}]}class he extends te{constructor(e){super(),ee(this,e,pe,fe,l,{parentDialogNode:5})}}function me(e,t,n){const o=e.slice();return o[24]=t[n],o[25]=t,o[26]=n,o}function ve(t){let n;return{c(){n=g("span"),n.textContent="¤",N(n,"title","Noeud terminal"),N(n,"class","svelte-idywcr")},m(e,t){c(e,n,t)},p:e,d(e){e&&d(n)}}}function Ne(e){let t,n,i,l,r,s,a,m,$,x,y,k,w,C=e[0].nextNodes.length+"";return{c(){t=f("svg"),n=f("use"),i=h(),l=f("svg"),r=f("use"),s=h(),a=g("span"),m=p("("),$=p(C),x=p(")"),N(n,"href","assets/sprite_icons.svg#angle-double-right"),_(t,"is-hidden",e[3]),N(r,"href","assets/sprite_icons.svg#angle-double-down"),_(l,"is-hidden",!e[3]),N(a,"class","is-primary svelte-idywcr"),N(a,"title",y="Ce noeud mène à "+e[0].nextNodes.length+" réplique(s)")},m(o,d){c(o,t,d),u(t,n),c(o,i,d),c(o,l,d),u(l,r),c(o,s,d),c(o,a,d),u(a,m),u(a,$),u(a,x),k||(w=[v(t,"click",e[11]),v(l,"click",e[11]),v(a,"click",e[11])],k=!0)},p(e,n){8&n&&_(t,"is-hidden",e[3]),8&n&&_(l,"is-hidden",!e[3]),1&n&&C!==(C=e[0].nextNodes.length+"")&&b($,C),1&n&&y!==(y="Ce noeud mène à "+e[0].nextNodes.length+" réplique(s)")&&N(a,"title",y)},d(e){e&&d(t),e&&d(i),e&&d(l),e&&d(s),e&&d(a),k=!1,o(w)}}}function $e(t){let n,o,i,l,r;return{c(){n=g("span"),o=f("svg"),i=f("use"),N(i,"href","assets/sprite_icons.svg#times-circle-solid"),N(o,"class","is-float-right ml-1"),N(n,"title","Supprimer le noeud (irréversible)"),N(n,"class","svelte-idywcr")},m(e,s){c(e,n,s),u(n,o),u(o,i),l||(r=v(o,"click",t[15]),l=!0)},p:e,d(e){e&&d(n),l=!1,r()}}}function be(t){let n,o,i,l,r;return{c(){n=g("span"),o=f("svg"),i=f("use"),N(i,"href","assets/sprite_icons.svg#times-circle-regular"),N(o,"class","is-float-right"),N(n,"title","Supprimer la filiation (le noeud ne sera pas supprimé, seul son lien avec son noeud parent)"),N(n,"class","svelte-idywcr")},m(e,s){c(e,n,s),u(n,o),u(o,i),l||(r=v(o,"click",t[14]),l=!0)},p:e,d(e){e&&d(n),l=!1,r()}}}function xe(e){let t,n,o;function i(t){e[19](t)}let l={};return void 0!==e[0]&&(l.dialogNode=e[0]),t=new re({props:l}),q.push((()=>Q(t,"dialogNode",i))),{c(){W(t.$$.fragment)},m(e,n){X(t,e,n),o=!0},p(e,o){const i={};!n&&1&o&&(n=!0,i.dialogNode=e[0],D((()=>n=!1))),t.$set(i)},i(e){o||(V(t.$$.fragment,e),o=!0)},o(e){G(t.$$.fragment,e),o=!1},d(e){Y(t,e)}}}function ye(e){let t,n;return t=new he({props:{parentDialogNode:e[0]}}),t.$on("updateNodeLists",e[20]),t.$on("toggleShowNewDialogNode",e[13]),{c(){W(t.$$.fragment)},m(e,o){X(t,e,o),n=!0},p(e,n){const o={};1&n&&(o.parentDialogNode=e[0]),t.$set(o)},i(e){n||(V(t.$$.fragment,e),n=!0)},o(e){G(t.$$.fragment,e),n=!1},d(e){Y(t,e)}}}function ke(e,t){let n,o,i,l;function r(e){t[21](e,t[24])}let s={gender:t[2],language:t[1],parentNodeId:t[0].id};return void 0!==t[8].dialogNodes[t[24]]&&(s.dialogNode=t[8].dialogNodes[t[24]]),o=new Ce({props:s}),q.push((()=>Q(o,"dialogNode",r))),o.$on("updateNodeLists",t[22]),{key:e,first:null,c(){n=m(),W(o.$$.fragment),this.first=n},m(e,t){c(e,n,t),X(o,e,t),l=!0},p(e,n){t=e;const l={};4&n&&(l.gender=t[2]),2&n&&(l.language=t[1]),1&n&&(l.parentNodeId=t[0].id),!i&&257&n&&(i=!0,l.dialogNode=t[8].dialogNodes[t[24]],D((()=>i=!1))),o.$set(l)},i(e){l||(V(o.$$.fragment,e),l=!0)},o(e){G(o.$$.fragment,e),l=!1},d(e){e&&d(n),Y(o,e)}}}function _e(e){let t,n,i,l,r,s,a,m,$,x,y,k,w,C,j,O,E,q,S,z,L,P,A,D,I,R,M,U,J,B,Q,W,X,Y=e[0].character+"",Z=e[9](e[0].text)+"",ee=(e[0].incomingNodes?.length||0)+"",te=[],ne=new Map;function oe(e,t){return e[5]?ve:Ne}let ie=oe(e),le=ie(e),re="1"!==e[0].id&&$e(e),se=e[0].incomingNodes.length>0&&be(e),ae=e[6]&&xe(e),ue=e[7]&&ye(e),ce=e[0].nextNodes;const de=e=>e[26];for(let t=0;t<ce.length;t+=1){let n=me(e,ce,t),o=de(n);ne.set(o,te[t]=ke(o,n))}return{c(){t=g("li"),n=g("div"),i=g("p"),le.c(),l=h(),r=g("strong"),s=p(Y),a=p(":\n      "),m=g("span"),$=p('"'),x=p(Z),y=p('"'),k=h(),w=f("svg"),C=f("use"),j=h(),O=g("span"),E=p("⇶ "),q=p(ee),S=p(" -"),L=h(),P=g("span"),A=f("svg"),D=f("use"),I=h(),re&&re.c(),R=h(),se&&se.c(),M=h(),ae&&ae.c(),U=h(),ue&&ue.c(),J=h(),B=g("ul");for(let e=0;e<te.length;e+=1)te[e].c();N(r,"class","svelte-idywcr"),N(m,"class","italic svelte-idywcr"),N(C,"href","assets/sprite_icons.svg#edit"),N(O,"class","is-primary svelte-idywcr"),N(O,"title",z=(e[0].incomingNodes?.length||0)+" répliques mène(nt) à ce noeud"),_(O,"is-hidden",!e[4]),N(D,"href","assets/sprite_icons.svg#plus-square"),N(P,"title","Ajouter une sous-réplique"),N(P,"class","svelte-idywcr"),N(i,"class","svelte-idywcr"),N(n,"class","dialog-node svelte-idywcr"),_(n,"is-player","Player"===e[0].character),_(B,"is-hidden",!e[3]),N(t,"id",e[10])},m(o,d){c(o,t,d),u(t,n),u(n,i),le.m(i,null),u(i,l),u(i,r),u(r,s),u(i,a),u(i,m),u(m,$),u(m,x),u(m,y),u(i,k),u(i,w),u(w,C),u(i,j),u(i,O),u(O,E),u(O,q),u(O,S),u(i,L),u(i,P),u(P,A),u(A,D),u(i,I),re&&re.m(i,null),u(i,R),se&&se.m(i,null),u(n,M),ae&&ae.m(n,null),u(n,U),ue&&ue.m(n,null),u(t,J),u(t,B);for(let e=0;e<te.length;e+=1)te[e].m(B,null);Q=!0,W||(X=[v(r,"click",e[11]),v(m,"click",e[11]),v(w,"click",e[12]),v(A,"click",e[13])],W=!0)},p(e,[t]){ie===(ie=oe(e))&&le?le.p(e,t):(le.d(1),le=ie(e),le&&(le.c(),le.m(i,l))),(!Q||1&t)&&Y!==(Y=e[0].character+"")&&b(s,Y),(!Q||1&t)&&Z!==(Z=e[9](e[0].text)+"")&&b(x,Z),(!Q||1&t)&&ee!==(ee=(e[0].incomingNodes?.length||0)+"")&&b(q,ee),(!Q||1&t&&z!==(z=(e[0].incomingNodes?.length||0)+" répliques mène(nt) à ce noeud"))&&N(O,"title",z),16&t&&_(O,"is-hidden",!e[4]),"1"!==e[0].id?re?re.p(e,t):(re=$e(e),re.c(),re.m(i,R)):re&&(re.d(1),re=null),e[0].incomingNodes.length>0?se?se.p(e,t):(se=be(e),se.c(),se.m(i,null)):se&&(se.d(1),se=null),e[6]?ae?(ae.p(e,t),64&t&&V(ae,1)):(ae=xe(e),ae.c(),V(ae,1),ae.m(n,U)):ae&&(F(),G(ae,1,1,(()=>{ae=null})),T()),e[7]?ue?(ue.p(e,t),128&t&&V(ue,1)):(ue=ye(e),ue.c(),V(ue,1),ue.m(n,null)):ue&&(F(),G(ue,1,1,(()=>{ue=null})),T()),1&t&&_(n,"is-player","Player"===e[0].character),263&t&&(ce=e[0].nextNodes,F(),te=K(te,t,de,1,e,ce,ne,B,H,ke,null,me),T()),8&t&&_(B,"is-hidden",!e[3])},i(e){if(!Q){V(ae),V(ue);for(let e=0;e<ce.length;e+=1)V(te[e]);Q=!0}},o(e){G(ae),G(ue);for(let e=0;e<te.length;e+=1)G(te[e]);Q=!1},d(e){e&&d(t),le.d(),re&&re.d(),se&&se.d(),ae&&ae.d(),ue&&ue.d();for(let e=0;e<te.length;e+=1)te[e].d();W=!1,o(X)}}}function we(e,t,n){let o;var i,l;s(e,ue,(e=>n(8,o=e)));let{language:r}=t,{gender:u}=t,{dialogNode:c}=t,{parentNodeId:d="1"}=t,g=!1,f=!1,p=!1,h=!1,m=!1;const v=j(),N=`${"0".repeat(5-String(c.id).length)}${c.id}`;return e.$$set=e=>{"language"in e&&n(1,r=e.language),"gender"in e&&n(2,u=e.gender),"dialogNode"in e&&n(0,c=e.dialogNode),"parentNodeId"in e&&n(16,d=e.parentNodeId)},e.$$.update=()=>{131073&e.$$.dirty&&n(4,f=(null===n(17,i=null==c?void 0:c.incomingNodes)||void 0===i?void 0:i.length)>1||!1),262145&e.$$.dirty&&n(5,p=(null===n(18,l=null==c?void 0:c.incomingNodes)||void 0===l?void 0:l.length)>1)},[c,r,u,g,f,p,h,m,o,e=>{var t,n;return(null===(t=null==e?void 0:e[r])||void 0===t?void 0:t[u])||(null===(n=null==e?void 0:e[r])||void 0===n?void 0:n.m)||(null==e?void 0:e[r])||e.fr},N,function(){n(3,g=!g),g||(n(6,h=g),n(7,m=g))},function(){n(6,h=!h),n(3,g=h),h&&n(7,m=!1)},function(e){var t;n(7,m=!m),!1!==(null===(t=null==e?void 0:e.detail)||void 0===t?void 0:t.toggleChildNodes)&&n(3,g=m),m&&n(6,h=!1)},function(){a(ue,o.dialogNodes[d].nextNodes=o.dialogNodes[d].nextNodes.filter((e=>e!==c.id)),o),v("updateNodeLists",{})},function(){Object.keys(o.dialogNodes).forEach((e=>{a(ue,o.dialogNodes[e].nextNodes=o.dialogNodes[e].nextNodes.filter((e=>e!==c.id)),o)})),delete o.dialogNodes[c.id],v("updateNodeLists",{})},d,i,l,function(e){c=e,n(0,c)},function(t){O(e,t)},function(t,n){e.$$.not_equal(o.dialogNodes[n],t)&&(o.dialogNodes[n]=t,ue.set(o))},function(t){O(e,t)}]}class Ce extends te{constructor(e){super(),ee(this,e,we,_e,l,{language:1,gender:2,dialogNode:0,parentNodeId:16})}}function je(e,t,n){const o=e.slice();return o[18]=t[n],o[19]=t,o[20]=n,o}function Oe(e,t,n){const o=e.slice();return o[18]=t[n],o[21]=t,o[20]=n,o}function Ee(t){let n;return{c(){n=g("p"),n.textContent="Veuillez charger un fichier de scénario JSON."},m(e,t){c(e,n,t)},p:e,i:e,o:e,d(e){e&&d(n)}}}function qe(e){let t,n,o,i,l,r,s,a,f,$,x,y,k,_,w,C,j,O,E,S=e[5].metadata.part+"",z=e[5].metadata.chapter+"";function L(t){e[10](t)}let P={gender:e[0],language:e[1]};void 0!==e[5].dialogNodes[1]&&(P.dialogNode=e[5].dialogNodes[1]),y=new Ce({props:P}),q.push((()=>Q(y,"dialogNode",L))),y.$on("updateNodeLists",e[6]);let A=e[4].length>0&&Se(e),I=e[3].length>0&&Le(e);return{c(){t=g("button"),t.textContent="Exporter Scénario",n=h(),o=g("h3"),i=p("Partie "),l=p(S),r=p(": Chapitre "),s=p(z),a=h(),f=g("h4"),f.textContent="Noeud Racine:",$=h(),x=g("ul"),W(y.$$.fragment),_=h(),A&&A.c(),w=h(),I&&I.c(),C=m(),N(t,"id","downloadlink"),N(t,"class","svelte-a63f12"),N(f,"class","svelte-a63f12")},m(d,g){c(d,t,g),c(d,n,g),c(d,o,g),u(o,i),u(o,l),u(o,r),u(o,s),c(d,a,g),c(d,f,g),c(d,$,g),c(d,x,g),X(y,x,null),c(d,_,g),A&&A.m(d,g),c(d,w,g),I&&I.m(d,g),c(d,C,g),j=!0,O||(E=v(t,"click",e[8]),O=!0)},p(e,t){(!j||32&t)&&S!==(S=e[5].metadata.part+"")&&b(l,S),(!j||32&t)&&z!==(z=e[5].metadata.chapter+"")&&b(s,z);const n={};1&t&&(n.gender=e[0]),2&t&&(n.language=e[1]),!k&&32&t&&(k=!0,n.dialogNode=e[5].dialogNodes[1],D((()=>k=!1))),y.$set(n),e[4].length>0?A?(A.p(e,t),16&t&&V(A,1)):(A=Se(e),A.c(),V(A,1),A.m(w.parentNode,w)):A&&(F(),G(A,1,1,(()=>{A=null})),T()),e[3].length>0?I?(I.p(e,t),8&t&&V(I,1)):(I=Le(e),I.c(),V(I,1),I.m(C.parentNode,C)):I&&(F(),G(I,1,1,(()=>{I=null})),T())},i(e){j||(V(y.$$.fragment,e),V(A),V(I),j=!0)},o(e){G(y.$$.fragment,e),G(A),G(I),j=!1},d(e){e&&d(t),e&&d(n),e&&d(o),e&&d(a),e&&d(f),e&&d($),e&&d(x),Y(y),e&&d(_),A&&A.d(e),e&&d(w),I&&I.d(e),e&&d(C),O=!1,E()}}}function Se(e){let t,n,o,i,l=[],r=new Map,s=e[4];const a=e=>e[20];for(let t=0;t<s.length;t+=1){let n=Oe(e,s,t),o=a(n);r.set(o,l[t]=ze(o,n))}return{c(){t=g("h4"),t.textContent="Noeud(s) à incidences multiples:",n=h(),o=g("ul");for(let e=0;e<l.length;e+=1)l[e].c();N(t,"title","Noeuds liés par plusieurs répliques"),N(t,"class","svelte-a63f12")},m(e,r){c(e,t,r),c(e,n,r),c(e,o,r);for(let e=0;e<l.length;e+=1)l[e].m(o,null);i=!0},p(e,t){115&t&&(s=e[4],F(),l=K(l,t,a,1,e,s,r,o,H,ze,null,Oe),T())},i(e){if(!i){for(let e=0;e<s.length;e+=1)V(l[e]);i=!0}},o(e){for(let e=0;e<l.length;e+=1)G(l[e]);i=!1},d(e){e&&d(t),e&&d(n),e&&d(o);for(let e=0;e<l.length;e+=1)l[e].d()}}}function ze(e,t){let n,o,i,l;function r(e){t[11](e,t[18])}let s={gender:t[0],language:t[1]};return void 0!==t[5].dialogNodes[t[18]]&&(s.dialogNode=t[5].dialogNodes[t[18]]),o=new Ce({props:s}),q.push((()=>Q(o,"dialogNode",r))),o.$on("updateNodeLists",t[6]),{key:e,first:null,c(){n=m(),W(o.$$.fragment),this.first=n},m(e,t){c(e,n,t),X(o,e,t),l=!0},p(e,n){t=e;const l={};1&n&&(l.gender=t[0]),2&n&&(l.language=t[1]),!i&&48&n&&(i=!0,l.dialogNode=t[5].dialogNodes[t[18]],D((()=>i=!1))),o.$set(l)},i(e){l||(V(o.$$.fragment,e),l=!0)},o(e){G(o.$$.fragment,e),l=!1},d(e){e&&d(n),Y(o,e)}}}function Le(e){let t,n,o,i,l=[],r=new Map,s=e[3];const a=e=>e[20];for(let t=0;t<s.length;t+=1){let n=je(e,s,t),o=a(n);r.set(o,l[t]=Pe(o,n))}return{c(){t=g("h4"),t.textContent="Noeud(s) orphelin(s):",n=h(),o=g("ul");for(let e=0;e<l.length;e+=1)l[e].c();N(t,"title","Noeuds n'étant la réplique d'aucun autre (et n'étant pas le noeud racine)"),N(t,"class","svelte-a63f12")},m(e,r){c(e,t,r),c(e,n,r),c(e,o,r);for(let e=0;e<l.length;e+=1)l[e].m(o,null);i=!0},p(e,t){107&t&&(s=e[3],F(),l=K(l,t,a,1,e,s,r,o,H,Pe,null,je),T())},i(e){if(!i){for(let e=0;e<s.length;e+=1)V(l[e]);i=!0}},o(e){for(let e=0;e<l.length;e+=1)G(l[e]);i=!1},d(e){e&&d(t),e&&d(n),e&&d(o);for(let e=0;e<l.length;e+=1)l[e].d()}}}function Pe(e,t){let n,o,i,l;function r(e){t[12](e,t[18])}let s={gender:t[0],language:t[1],parentNodeId:"1"};return void 0!==t[5].dialogNodes[t[18]]&&(s.dialogNode=t[5].dialogNodes[t[18]]),o=new Ce({props:s}),q.push((()=>Q(o,"dialogNode",r))),o.$on("updateNodeLists",t[6]),{key:e,first:null,c(){n=m(),W(o.$$.fragment),this.first=n},m(e,t){c(e,n,t),X(o,e,t),l=!0},p(e,n){t=e;const l={};1&n&&(l.gender=t[0]),2&n&&(l.language=t[1]),!i&&40&n&&(i=!0,l.dialogNode=t[5].dialogNodes[t[18]],D((()=>i=!1))),o.$set(l)},i(e){l||(V(o.$$.fragment,e),l=!0)},o(e){G(o.$$.fragment,e),l=!1},d(e){e&&d(n),Y(o,e)}}}function Ae(e){let t,n,i,l,r,s,a,f,p,m,$,b,x;const y=[qe,Ee],k=[];function _(e,t){return 32&t&&(f=!!(Object.keys(e[5].dialogNodes).length>0)),f?0:1}return p=_(e,-1),m=k[p]=y[p](e),{c(){t=g("main"),n=g("h1"),n.textContent="Auto-Diagnostique",i=h(),l=g("h2"),l.textContent="Outil d'édition de dialogues",r=h(),s=g("input"),a=h(),m.c(),N(n,"class","svelte-a63f12"),N(s,"accept","application/json"),N(s,"type","file"),N(s,"id","scenarioFile"),N(t,"class","svelte-a63f12")},m(o,d){c(o,t,d),u(t,n),u(t,i),u(t,l),u(t,r),u(t,s),u(t,a),k[p].m(t,null),$=!0,b||(x=[v(s,"change",e[9]),v(s,"change",e[7])],b=!0)},p(e,[n]){let o=p;p=_(e,n),p===o?k[p].p(e,n):(F(),G(k[o],1,1,(()=>{k[o]=null})),T(),m=k[p],m?m.p(e,n):(m=k[p]=y[p](e),m.c()),V(m,1),m.m(t,null))},i(e){$||(V(m),$=!0)},o(e){G(m),$=!1},d(e){e&&d(t),k[p].d(),b=!1,o(x)}}}function De(e,t,n){let o;s(e,ue,(e=>n(5,o=e)));var i=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,l){function r(e){try{a(o.next(e))}catch(e){l(e)}}function s(e){try{a(o.throw(e))}catch(e){l(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}a((o=o.apply(e,t||[])).next())}))};let l,r,{gender:u}=t,{language:c}=t,d=[],g=[];function f(){Object.entries(o.dialogNodes).forEach((([e,t])=>{t.incomingNodes=[]})),Object.entries(o.dialogNodes).forEach((([e,t])=>{t.nextNodes.forEach((t=>{a(ue,o.dialogNodes[t].incomingNodes=[...o.dialogNodes[t].incomingNodes||[],e],o)}))})),n(3,d=Object.keys(o.dialogNodes).reduce(((e,t)=>{var n,i;return 0===(null===(i=null===(n=o.dialogNodes[t])||void 0===n?void 0:n.incomingNodes)||void 0===i?void 0:i.length)&&"1"!==t?[...e,t]:e}),[])),n(4,g=Object.keys(o.dialogNodes).reduce(((e,t)=>{var n,i;return(null===(i=null===(n=o.dialogNodes[t])||void 0===n?void 0:n.incomingNodes)||void 0===i?void 0:i.length)>1?[...e,t]:e}),[]))}return e.$$set=e=>{"gender"in e&&n(0,u=e.gender),"language"in e&&n(1,c=e.language)},[u,c,l,d,g,o,f,function(){return i(this,void 0,void 0,(function*(){const e=yield l[0].text();r=l[0].name,ue.set(JSON.parse(e)),f()}))},function(){const e=Object.keys(o.dialogNodes).reduce(((e,t,n)=>Object.assign(Object.assign({},e),{[t]:String(n+1)})),{}),t={metadata:Object.assign({},o.metadata),dialogNodes:Object.assign({},Object.fromEntries(Object.entries(o.dialogNodes).map((([t,n],o)=>{let i=Object.assign({},n);return delete i.incomingNodes,i.nextNodes=i.nextNodes.map((t=>e[t])),i.id=String(o+1),[o+1,i]}))))},n=document.createElement("a"),i=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),l=URL.createObjectURL(i);n.href=l,n.download=r,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(l)},function(){l=this.files,n(2,l)},function(t){e.$$.not_equal(o.dialogNodes[1],t)&&(o.dialogNodes[1]=t,ue.set(o))},function(t,n){e.$$.not_equal(o.dialogNodes[n],t)&&(o.dialogNodes[n]=t,ue.set(o))},function(t,n){e.$$.not_equal(o.dialogNodes[n],t)&&(o.dialogNodes[n]=t,ue.set(o))}]}return new class extends te{constructor(e){super(),ee(this,e,De,Ae,l,{gender:0,language:1})}}({target:document.body,props:{language:"fr",gender:"m"}})}();
//# sourceMappingURL=bundle.js.map
